<font size="5">1. What is this
</font>
<div><br>
</div>
<div><font size="3">This project is about to write different shaders using GLSL to make different effects to a live video captured from a webcam with OpenCV.</font></div>
<div><font size="3"><br>
</font></div>
<div><font size="3">I finished two pages of shaders. Other effects I acquired during this project are all in the same difficulty level, so I decided not to put them into the third page.</font></div>
<div><font size="3"><br>
</font></div>
<div><font size="3">The video I created as a demonstration is here:&nbsp;http://www.youtube.com/watch?v=pG3Vt1MvlwQ</font></div>
<div><font size="3"><br>
</font></div>
<img src="https://www.google.com/chart?chc=sites&amp;cht=d&amp;chdp=sites&amp;chl=%5B%5BYouTube+video'%3D20'f%5Cv'a%5C%3D0'10'%3D425'0'dim'%5Cbox1'b%5CF6F6F6'fC%5CF6F6F6'eC%5C0'sk'%5C%5B'%5D'a%5CV%5C%3D12'f%5C%5DV%5Cta%5C%3D10'%3D0'%3D426'%3D352'dim'%5C%3D10'%3D10'%3D426'%3D352'vdim'%5Cbox1'b%5Cva%5CF6F6F6'fC%5CC8C8C8'eC%5C'a%5C%5Do%5CLauto'f%5C&amp;sig=1kZZm6Qdm0n3cd5cO3Yf-w81vmg" data-origsrc="pG3Vt1MvlwQ" data-type="youtube" data-props="" width="425" height="355" style="display:block;text-align:left;margin-right:auto;">

<div><font size="3"><br>
</font></div>
<div><font size="3"><span style="line-height:20px"><a href="http://joysword.com/cs525/p1.zip">Click here</a> to download the source code. Or you can scroll down to the bottom of this page, you can find source code in attachment.</span></font></div>
<div><font size="3"><br>
</font></div>
<div><font size="5">2. How to Start</font></div>
<div><br>
</div>
<div><font size="3">You should first install <a href="http://opencv.willowgarage.com/wiki/InstallGuide" target="_blank">OpenCV</a>, <a href="http://glew.sourceforge.net/index.html" target="_blank">GLEW</a> and <a href="http://www.opengl.org/resources/libraries/glut/" target="_blank">GLUT</a> on your computer.</font></div>
<div><font size="3"><br>
</font></div>
<div><font size="3">Of course you also need a webcam.</font></div>
<div><font size="3"><span style="line-height:20px"><br>
</span></font></div>
<div><font size="3">If you are using Windows, just create a new command line project in Visual Studio, add all files into it, compile and run.</font></div>
<div><font size="3"><br>
</font></div>
<div><font size="3">If you are using Mac OS X, use makefile to build and run the application from terminal.</font></div>
<div><font size="3"><br>
</font></div>
<div><font size="5">3. How to Use</font></div>
<div><br>
</div>
<div><font size="3">The shaders are separated into three pages (in my case two pages).</font></div>
<div><font size="3">- Use keyboard <font color="#ffff00">"1" "2" and "3"</font> to jump to certain page you want to check.</font></div>
<div><font size="3">- You can recognize which page are you currently in by checking the title of the application window.</font></div>
<div><font size="3"><br>
</font></div>
<div><font size="3">In each page, there are 3 different shaded live videos and one untouched video that in the upper left grid of the window.</font></div>
<div><font size="3">- Use keyboard <font color="#ffff00">"a" "q" "s" and "w"</font> to toggle one of the 4 videos to fullscreen mode. You can also use <font color="#ffff00">mouse click</font> to choose videos.</font></div>
<div><font size="3">- The name of the effect you are watching is in the title of the application window.</font></div>
<div><font size="3">- Use keyboard <font color="#ffff00">"z"</font> to go back to the overview mode. You can also just <font color="#ffff00">click the mouse</font> to go back.</font></div>
<div><br>
</div>
<div><font size="5">4. What I did</font></div>
<div><br>
</div>
<div><font size="4"><b><u>4.0 Introduction</u></b></font></div>
<div><font size="3"><span style="line-height:20px"><br>
</span></font></div>
<div><font color="#ff0000" size="3"><span style="line-height:20px">[P] [P]</span></font></div>
<div><font size="3"><span style="line-height:20px"><br>
</span></font></div>
<div><font size="3"><span style="line-height:20px">- Overview:</span></font></div>
<div><font size="3"><span style="line-height:20px">Control mechanism of this application is omitted here for clarity. If interested, you can refer to the <a href="http://joysword.com/cs525/webcam.zip">source code</a>.</span></font></div>
<div><span style="line-height:20px;font-size:medium"><br>
</span></div>
<div><span style="line-height:20px;font-size:medium">- Code:</span></div>
<div><span style="line-height:20px;font-size:medium">Vertex shader:</span></div>
<div><span style="line-height:20px">
<p style="margin-top:0px;margin-right:0px;margin-bottom:0px;margin-left:0px;font:normal normal normal 13px/normal 'Courier New';color:rgb(0,46,250)"><font size="3"><span>&nbsp;&nbsp; &nbsp;</span>varying<span style="color:rgb(210,210,210)"> </span>vec2<span style="color:rgb(210,210,210)"> TexCoord;</span></font></p>
<p style="margin-top:0px;margin-right:0px;margin-bottom:0px;margin-left:0px;font:normal normal normal 13px/normal 'Courier New';color:rgb(210,210,210)"><font size="3"><span style="color:#002efa"><font size="3"><span>&nbsp;&nbsp; &nbsp;</span>uniform</font></span><font size="3"> <span style="color:#002efa">int</span> whichEffect;</font></font></p>
<p style="margin-top:0px;margin-right:0px;margin-bottom:0px;margin-left:0px;font:normal normal normal 13px/normal 'Courier New';color:rgb(210,210,210)"><font size="3"><font size="3"><br>
</font></font></p>
<p style="margin:0px 0px 0px 0px;font:13.0px 'Courier New';color:#002efa"><font size="3"><font size="3"><span>&nbsp;&nbsp; &nbsp;</span>void<span style="color:#d2d2d2"> main (</span>void<span style="color:#d2d2d2">)</span></font></font></p>
<p style="margin:0px 0px 0px 0px;font:13.0px 'Courier New';color:#002efa"><font size="3"><font size="3"><span style="color:#d2d2d2"><span>&nbsp;&nbsp; &nbsp;</span>{</span></font></font></p>
<p style="margin:0px 0px 0px 0px;font:13.0px 'Courier New';color:#002efa"><font size="3"><font size="3"><span style="color:#d2d2d2"><span>&nbsp;&nbsp; &nbsp;<span>&nbsp; &nbsp; ...</span></span><br>
</span></font></font></p>
<p style="margin-top:0px;margin-right:0px;margin-bottom:0px;margin-left:0px;font:normal normal normal 13px/normal 'Courier New';color:rgb(210,210,210)"><font size="3"><font size="3"><span>&nbsp;&nbsp; &nbsp;<span>&nbsp;&nbsp; &nbsp;</span></span>TexCoord &nbsp; &nbsp; = gl_MultiTexCoord0.st;</font></font></p>
<font size="3">
<p style="margin-top:0px;margin-right:0px;margin-bottom:0px;margin-left:0px;font:normal normal normal 13px/normal 'Courier New';color:rgb(210,210,210)"><font size="3">&nbsp;&nbsp; &nbsp;<span>&nbsp;&nbsp; &nbsp;</span>gl_Position&nbsp; = ftransform();</font></p>
<p style="margin-top:0px;margin-right:0px;margin-bottom:0px;margin-left:0px;font:normal normal normal 13px/normal 'Courier New';color:rgb(210,210,210)"><font size="3"><span>&nbsp;&nbsp; &nbsp;</span>}</font></p>
</font></span></div>
<div><font size="3"><br>
</font></div>
<div><font size="3">Fragment shader:</font></div>
<div>
<p style="margin:0px 0px 0px 0px;font:13.0px 'Courier New';color:#d2d2d2"><font size="3"><font size="3"><span style="color:#002efa"><span>&nbsp;&nbsp; &nbsp;</span>uniform</span> <span style="color:#002efa">int</span> whichEffect;</font></font></p>
<font size="3">
<p style="margin:0px 0px 0px 0px;font:13.0px 'Courier New';color:#002efa"><font size="3"><span>&nbsp;&nbsp; &nbsp;</span>varying<span style="color:#d2d2d2"> </span>vec2<span style="color:#d2d2d2"> TexCoord;</span></font></p>
<p style="margin:0px 0px 0px 0px;font:13.0px 'Courier New';color:#002efa"><span style="color:#d2d2d2"><br>
</span></p>
<p style="margin:0px 0px 0px 0px;font:13.0px 'Courier New';color:#d2d2d2"><font size="3"><span style="color:#002efa"><span>&nbsp;&nbsp; &nbsp;</span>uniform</span> sampler2DRect whichTexture;</font></p>
</font></div>
<div><font size="3">
<p style="margin:0px 0px 0px 0px;font:13.0px 'Courier New';color:#002efa"><font size="3"><br>
</font></p>
<p style="margin:0px 0px 0px 0px;font:13.0px 'Courier New';color:#002efa"><font size="3"><span>&nbsp;&nbsp; &nbsp;</span>void<span style="color:#d2d2d2"> main(</span>void<span style="color:#d2d2d2">)</span></font></p>
<p style="margin:0px 0px 0px 0px;font:13.0px 'Courier New';color:#d2d2d2"><font size="3"><span>&nbsp;&nbsp; &nbsp;</span>{</font></p>
<p style="margin:0px 0px 0px 0px;font:13.0px 'Courier New';color:#d2d2d2"><font size="3"><span style="color:#002efa"><span>&nbsp;&nbsp; &nbsp;<span>&nbsp;&nbsp; &nbsp;</span></span>vec4</span> sum = <span style="color:#002efa">vec4</span>(<span style="color:#9a1f90">0.0</span>);</font></p>
<p style="margin:0px 0px 0px 0px;font:13.0px 'Courier New';color:#d2d2d2"><font size="3"><span style="color:#002efa"><span>&nbsp;&nbsp; &nbsp;<span>&nbsp;&nbsp; &nbsp;</span></span>vec4</span> part = <span style="color:#002efa">vec4</span>(<span style="color:#9a1f90">0.0</span>);</font></p>
<p style="margin:0px 0px 0px 0px;font:13.0px 'Courier New';color:#d2d2d2"><font size="3"><span>&nbsp;&nbsp; &nbsp;<span>&nbsp; &nbsp; ...</span></span><br>
</font></p>
<p style="margin:0px 0px 0px 0px;font:13.0px 'Courier New';color:#d2d2d2"><font size="3"><span>&nbsp;&nbsp; &nbsp;<span>&nbsp;&nbsp; &nbsp;</span></span>gl_FragColor = sum;</font></p>
<p style="margin:0px 0px 0px 0px;font:13.0px 'Courier New';color:#d2d2d2"><font size="3"><span>&nbsp;&nbsp; &nbsp;</span>}</font></p>
<p style="margin:0px 0px 0px 0px;font:13.0px 'Courier New';color:#d2d2d2"><br>
</p>
</font></div>
<div><font size="4"><b><u>4.1 Two Face</u></b></font></div>
<div><font size="3"><span style="line-height:20px"><br>
</span></font></div>
<div><font color="#ff0000" size="3"><span style="line-height:20px">[P]</span></font></div>
<div><font size="3"><br>
</font></div>
<div><font size="3">- Overview:</font></div>
<div><font size="3"><span style="line-height:20px">First page, lower left.</span></font></div>
<div><font size="3"><span style="line-height:20px">It's just a warm up <u>color modification</u> effect.</span></font></div>
<div><font size="3"><span style="line-height:20px"><br>
</span></font></div>
<div><font color="#ffff00" size="3">- Principle:</font></div>
<div><font size="3">Simple, just use in</font><span style="font-size:medium">verse color in left half of the video area.</span></div>
<div><span style="font-size:medium"><br>
</span></div>
<div><font size="3">- Code:</font></div>
<div><font size="3"><span style="line-height:20px">Fragment shader:</span></font></div>
<div><font size="3"><span style="line-height:20px">
<p style="margin:0px 0px 0px 0px;font:13.0px 'Courier New';color:#d2d2d2"><span style="color:#002efa"><font size="3"><span>&nbsp;&nbsp; &nbsp;</span>if</font></span><font size="3"> (whichEffect == <span style="color:#9a1f90">0</span>)</font></p>
<p style="margin:0px 0px 0px 0px;font:13.0px 'Courier New';color:#008419"><font size="3"><span>&nbsp;&nbsp; &nbsp;</span>// inverse</font></p>
<p style="margin:0px 0px 0px 0px;font:13.0px 'Courier New';color:#d2d2d2"><font size="3"><span>&nbsp;&nbsp; &nbsp;</span>{</font></p>
<p style="margin:0px 0px 0px 0px;font:13.0px 'Courier New';color:#d2d2d2"><font size="3"><span>&nbsp;&nbsp; &nbsp;<span>&nbsp;&nbsp; &nbsp;</span></span>part = texture2DRect(whichTexture, TexCoord.xy);</font></p>
</span><span style="color:rgb(210,210,210);font-family:Courier New;line-height:normal"><span style="color:#002efa"><span>&nbsp;&nbsp; &nbsp;<span>&nbsp;&nbsp; &nbsp;</span></span>if</span> (TexCoord.x &lt; <span style="color:#9a1f90">400.0</span>)</span><span style="line-height:20px">
<p style="margin:0px 0px 0px 0px;font:13.0px 'Courier New';color:#d2d2d2"><font size="3"><span>&nbsp;&nbsp; &nbsp;<span>&nbsp;&nbsp; &nbsp;</span></span>{</font></p>
<p style="margin:0px 0px 0px 0px;font:13.0px 'Courier New';color:#d2d2d2"><font size="3"><span>&nbsp;&nbsp; &nbsp;<span>&nbsp;&nbsp; &nbsp;<span>&nbsp;&nbsp; &nbsp;</span></span></span>part = <span style="color:#002efa">vec4</span>(<span style="color:#9a1f90">1.0</span>, <span style="color:#9a1f90">1.0</span>, <span style="color:#9a1f90">1.0</span>, <span style="color:#9a1f90">1.0</span>) - part;</font></p>
<p style="margin:0px 0px 0px 0px;font:13.0px 'Courier New';color:#d2d2d2"><font size="3"><span>&nbsp;&nbsp; &nbsp;<span>&nbsp;&nbsp; &nbsp;</span></span>}</font></p>
<p style="margin:0px 0px 0px 0px;font:13.0px 'Courier New';color:#d2d2d2"><font size="3"><span>&nbsp;&nbsp; &nbsp;<span>&nbsp;&nbsp; &nbsp;</span></span>sum = part;</font></p>
<p style="margin:0px 0px 0px 0px;font:13.0px 'Courier New';color:#d2d2d2"><span><font size="3"><span>&nbsp;&nbsp; &nbsp;</span>}</font></span></p>
</span></font></div>
<div><font size="3"><span style="line-height:20px"><br>
</span></font></div>
<div><font size="4"><u><b>4.2 For the Record</b></u></font></div>
<div><font size="3"><br>
</font></div>
<div><font size="3"><span style="color:rgb(255,0,0)">[P]</span></font></div>
<div><font size="3"><span style="color:rgb(255,0,0)"><br>
</span></font></div>
<div><font size="3">- Overview:</font></div>
<div><font size="3">Fist page, lower right.</font></div>
<div><font size="3">It's a <u>relief sculpture</u> effect.</font></div>
<div><font size="3"><br>
</font></div>
<div><font color="#ffff00" size="3"><span style="line-height:20px">- Principle:</span></font></div>
<div><font size="3">Compute the difference between the color of current pixel and that of its upper left neighbor.</font></div>
<div><font size="3">Convert it to&nbsp;<span style="line-height:20px">luminance.</span></font></div>
<div><font size="3"><span style="line-height:20px">Add a gray backgroud color to it.</span></font></div>
<div><font size="3"><br>
</font></div>
<div><font size="3">- Code:</font></div>
<div><font size="3">Fragment shader:</font></div>
<div><font size="3">
<p style="margin:0px 0px 0px 0px;font:13.0px 'Courier New';color:#d2d2d2"><span style="color:#002efa"><span>&nbsp;&nbsp; &nbsp;</span><font size="3">if</font></span><font size="3"> (whichEffect == <span style="color:#9a1f90">2</span>)</font></p>
<p style="margin:0px 0px 0px 0px;font:13.0px 'Courier New';color:#008419"><font size="3"><span>&nbsp;&nbsp; &nbsp;</span>// sculpture</font></p>
<p style="margin:0px 0px 0px 0px;font:13.0px 'Courier New';color:#d2d2d2"><font size="3"><span>&nbsp;&nbsp; &nbsp;</span>{</font></p>
<p style="margin:0px 0px 0px 0px;font:13.0px 'Courier New';color:#d2d2d2"><font size="3"><span style="white-space:pre">	</span>part = texture2DRect(whichTexture, TexCoord.xy);</font></p>
<p style="margin:0px 0px 0px 0px;font:13.0px 'Courier New';color:#d2d2d2"><font size="3"><span style="white-space:pre">	</span><span style="color:#002efa">vec2</span> ulCoord = <span style="color:#002efa">vec2</span>(max(TexCoord.x - <span style="color:#9a1f90">1.0</span>, <span style="color:#9a1f90">0.0</span>), max(TexCoord.y - <span style="color:#9a1f90">1.0</span>, <span style="color:#9a1f90">0.0</span>));</font></p>
<p style="margin:0px 0px 0px 0px;font:13.0px 'Courier New';color:#d2d2d2"><font size="3"><span style="white-space:pre">	</span><span style="color:#002efa">vec4</span> ulColor = texture2DRect(whichTexture, ulCoord);</font></p>
<p style="margin:0px 0px 0px 0px;font:13.0px 'Courier New';color:#d2d2d2;min-height:15.0px"><span style="white-space:pre"><font size="3">	</font></span></p>
<p style="margin:0px 0px 0px 0px;font:13.0px 'Courier New';color:#d2d2d2"><font size="3"><span style="white-space:pre">	</span><span style="color:#002efa">vec4</span> bkColor = <span style="color:#002efa">vec4</span>(<span style="color:#9a1f90">0.5</span>, <span style="color:#9a1f90">0.5</span>, <span style="color:#9a1f90">0.5</span>, <span style="color:#9a1f90">1.0</span>);</font></p>
<p style="margin:0px 0px 0px 0px;font:13.0px 'Courier New';color:#d2d2d2"><font size="3"><span style="white-space:pre">	</span><span style="color:#002efa">vec4</span> delColor = part - ulColor;</font></p>
<p style="margin:0px 0px 0px 0px;font:13.0px 'Courier New';color:#d2d2d2;min-height:15.0px"><font size="3"><br>
</font></p>
<p style="margin:0px 0px 0px 0px;font:13.0px 'Courier New';color:#d2d2d2"><font size="3"><span style="white-space:pre">	</span><span style="color:#002efa">float</span> h = <span style="color:#9a1f90">0.2125</span> * delColor.r + <span style="color:#9a1f90">0.7154</span> * delColor.g + <span style="color:#9a1f90">0.0721</span> * delColor.b;</font></p>
<p style="margin:0px 0px 0px 0px;font:13.0px 'Courier New';color:#d2d2d2"><font size="3"><span style="white-space:pre">	</span>sum.r = h;</font></p>
<p style="margin:0px 0px 0px 0px;font:13.0px 'Courier New';color:#d2d2d2"><font size="3"><span style="white-space:pre">	</span>sum.g = h;</font></p>
<p style="margin:0px 0px 0px 0px;font:13.0px 'Courier New';color:#d2d2d2"><font size="3"><span style="white-space:pre">	</span>sum.b = h;</font></p>
<p style="margin:0px 0px 0px 0px;font:13.0px 'Courier New';color:#d2d2d2;min-height:15.0px"><font size="3"><br>
</font></p>
<p style="margin:0px 0px 0px 0px;font:13.0px 'Courier New';color:#d2d2d2"><font size="3"><span style="white-space:pre">	</span>sum = delColor + bkColor;</font></p>
<p style="margin:0px 0px 0px 0px;font:13.0px 'Courier New';color:#d2d2d2"><font size="3"><span>&nbsp;&nbsp; &nbsp;</span>}</font></p>
<div><br>
</div>
</font></div>
<div><span style="line-height:20px;font-size:medium">- Memo:</span></div>
<div><font size="3"><span style="line-height:20px">Reference:&nbsp;</span><a href="http://group.lehu.shu.edu.cn/Article.aspx?aid=147793">http://group.lehu.shu.edu.cn/Article.aspx?aid=147793</a>&nbsp;(Note: it's Chinese), I changed it from HLSL to GLSL.</font></div>
<div><span style="line-height:20px;font-size:medium"><br>
</span></div>
<div><font size="4"><u>4.3 Privacy</u></font></div>
<div><font size="3"><br>
</font></div>
<div><font color="#ff0000" size="3">[P]</font></div>
<div><font size="3"><br>
</font></div>
<div><font size="3">- Overview:</font></div>
<div><font size="3">First page, upper right.</font></div>
<div><font size="3">It's a <u>mosaic</u> effect.</font></div>
<div><font size="3"><br>
</font></div>
<div><font color="#ffff00" size="3"><span style="line-height:20px">- Principle:</span></font></div>
<div><font size="3"><span style="line-height:20px">Divide screen to several squares, then u</span></font><span style="line-height:20px;font-size:medium">se the color of upper left pixel of a square to represent all pixels in this square.</span></div>
<div><font size="3"><span style="line-height:20px"><br>
</span></font></div>
<div><font size="3"><span style="line-height:20px">- Code:</span></font></div>
<div><font size="3"><span style="line-height:20px">Fragment shader:</span></font></div>
<div><font size="3"><span style="line-height:20px">
<p style="margin:0px 0px 0px 0px;font:13.0px 'Courier New';color:#d2d2d2"><span style="color:#002efa"><font size="3"><span>&nbsp;&nbsp; &nbsp;</span>if</font></span><font size="3"> (whichEffect == <span style="color:#9a1f90">3</span>)</font></p>
<p style="margin:0px 0px 0px 0px;font:13.0px 'Courier New';color:#008419"><font size="3"><span>&nbsp;&nbsp; &nbsp;</span>// mosaic</font></p>
<p style="margin:0px 0px 0px 0px;font:13.0px 'Courier New';color:#d2d2d2"><font size="3"><span>&nbsp;&nbsp; &nbsp;</span>{</font></p>
<p style="margin:0px 0px 0px 0px;font:13.0px 'Courier New';color:#d2d2d2"><font size="3"><span style="white-space:pre">	</span><span style="color:#002efa">vec2</span> mosaic = <span style="color:#002efa">vec2</span>(<span style="color:#002efa">int</span>(TexCoord.x / <span style="color:#9a1f90">24.0</span>) * <span style="color:#9a1f90">24</span>, <span style="color:#002efa">int</span>(TexCoord.y / <span style="color:#9a1f90">24.0</span>) * <span style="color:#9a1f90">24</span>);</font></p>
<p style="margin:0px 0px 0px 0px;font:13.0px 'Courier New';color:#d2d2d2"><font size="3"><span style="white-space:pre">	</span><span style="color:#002efa">vec3</span> color = <span style="color:#002efa">vec3</span>(texture2DRect(whichTexture, mosaic));&nbsp; &nbsp; &nbsp; &nbsp;</font></p>
<p style="margin:0px 0px 0px 0px;font:13.0px 'Courier New';color:#d2d2d2"><font size="3"><span style="white-space:pre">	</span>sum=<span style="color:#002efa">vec4</span>(color, <span style="color:#9a1f90">1.0</span>);</font></p>
<p style="margin:0px 0px 0px 0px;font:13.0px 'Courier New';color:#d2d2d2"><font size="3"><span>&nbsp;&nbsp; &nbsp;</span>}</font></p>
</span></font></div>
<div><font size="3"><span style="line-height:20px"><br>
</span></font></div>
<div><font size="3"><span style="line-height:20px">- Memo:</span></font></div>
<div><font size="3"><span style="line-height:20px">Reference:&nbsp;<a href="http://group.lehu.shu.edu.cn/Article.aspx?aid=147793">http://group.lehu.shu.edu.cn/Article.aspx?aid=147793</a>&nbsp;(Note: it's still Chinese),&nbsp;I changed it from HLSL to GLSL.</span></font></div>
<div><font size="3"><span style="line-height:20px"><br>
</span></font></div>
<div><font size="4"><u>4.4 Just Like Old Times</u></font></div>
<div><font size="3"><br>
</font></div>
<div><font color="#ff0000" size="3">[P]</font></div>
<div><font size="3"><br>
</font></div>
<div><font size="3">- Overview:</font></div>
<div><font size="3">Second page, lower left.</font></div>
<div><font size="3">It's a (not very realistic) <u>old photo</u>&nbsp;effect.</font></div>
<div><font size="3"><br>
</font></div>
<div><font color="#ffff00" size="3">- Principle:</font></div>
<div><font size="3">For each pixel, compute its color by adding its color and its eight near neighbor pixels as well as eight far neighbor pixels, then divide by 17 to get the average color.</font></div>
<div><font size="3">Convert it to luminance.</font></div>
<div><font size="3"><span style="line-height:20px">Mix it with sepia color.</span></font></div>
<div><font size="3">Add some 3D noise generated in main application program to it.</font></div>
<div><font size="3">Add a frame to it.</font></div>
<div><font size="3"><br>
</font></div>
<div><font size="3">- Code:</font></div>
<div><font size="3"><span style="line-height:20px">Vertex shader:</span></font></div>
<div><span style="line-height:20px"><font size="3">
<p style="margin:0px 0px 0px 0px;font:13.0px 'Courier New';color:#d2d2d2"><font size="3"><span style="color:#002efa"><span>&nbsp;&nbsp; &nbsp;</span>varying</span> <span style="color:#002efa">vec3</span> MCposition;</font></p>

<p style="margin:0px 0px 0px 0px;font:13.0px 'Courier New';color:#d2d2d2"><font size="3"><span style="color:#002efa"><span>&nbsp;&nbsp; &nbsp;</span>varying</span> <span style="color:#002efa">float&nbsp;</span>LightIntensity;</font></p>
<p style="margin:0px 0px 0px 0px;font:13.0px 'Courier New';color:#d2d2d2"><font size="3"><span style="color:#002efa"><span>&nbsp;&nbsp; &nbsp;</span>varying</span> <span style="color:#002efa">vec2&nbsp;</span>NoiseCoord;</font></p>
<p style="margin:0px 0px 0px 0px;font:13.0px 'Courier New';color:#d2d2d2"><font size="3"><br>
</font></p>
<p style="margin:0px 0px 0px 0px;font:13.0px 'Courier New';color:#d2d2d2"><span style="font-size:medium;color:rgb(0,46,250)"><span>&nbsp;&nbsp; &nbsp;</span>vec3</span><span style="font-size:medium">&nbsp;LightPos =&nbsp;</span><span style="font-size:medium;color:rgb(0,46,250)">vec3</span><span style="font-size:medium">(1.0);</span></p>

</font></span></div>
<div><font size="3"><span style="line-height:20px">
<p style="margin:0px 0px 0px 0px;font:13.0px 'Courier New';color:#d2d2d2"><span style="color:#002efa"><font size="3"><span>&nbsp;&nbsp; &nbsp;</span></font></span></p>
<p style="margin:0px 0px 0px 0px;font:13.0px 'Courier New';color:#d2d2d2"><span style="color:#002efa"><font size="3"><span>&nbsp;&nbsp; &nbsp;</span>if</font></span><font size="3"> (whichEffect == <span style="color:#9a1f90">4</span>)</font></p>
<p style="margin:0px 0px 0px 0px;font:13.0px 'Courier New';color:#008419"><font size="3"><span>&nbsp;&nbsp; &nbsp;</span>// noise</font></p>
<p style="margin:0px 0px 0px 0px;font:13.0px 'Courier New';color:#d2d2d2"><font size="3"><span>&nbsp;&nbsp; &nbsp;</span>{</font></p>
<p style="margin:0px 0px 0px 0px;font:13.0px 'Courier New';color:#d2d2d2"><font size="3"><span style="color:#002efa"><span>&nbsp;&nbsp; &nbsp;<span>&nbsp;&nbsp; &nbsp;</span></span>vec3</span> ECposition = <span style="color:#002efa">vec3</span>(gl_ModelViewMatrix * gl_Vertex);</font></p>
<p style="margin:0px 0px 0px 0px;font:13.0px 'Courier New';color:#d2d2d2"><font size="3"><span style="white-space:pre">	</span>MCposition = <span style="color:#002efa">vec3</span>(gl_Vertex);</font></p>
<p style="margin:0px 0px 0px 0px;font:13.0px 'Courier New';color:#d2d2d2"><font size="3"><span style="white-space:pre">	</span><span style="color:#002efa">vec3</span> tnorm = normalize(<span style="color:#002efa">vec3</span>(gl_NormalMatrix * gl_Normal));</font></p>
<p style="margin:0px 0px 0px 0px;font:13.0px 'Courier New';color:#d2d2d2"><font size="3"><span style="white-space:pre">	</span>LightIntensity = dot(normalize(LightPos - ECposition), tnorm);</font></p>
<p style="margin:0px 0px 0px 0px;font:13.0px 'Courier New';color:#d2d2d2"><font size="3"><span>&nbsp;&nbsp; &nbsp;</span>}</font></p>
</span></font></div>
<div><font size="3"><span style="line-height:20px"><br>
</span></font></div>
<div><font size="3"><span style="line-height:20px">Fragment shader:</span></font></div>
<div><font size="3"><span style="line-height:20px">
<p style="margin-top:0px;margin-right:0px;margin-bottom:0px;margin-left:0px;font:normal normal normal 13px/normal 'Courier New';color:rgb(210,210,210)"><font size="3"><span style="color:rgb(0,46,250)"><span>&nbsp;&nbsp; &nbsp;</span>varying</span>&nbsp;<span style="color:rgb(0,46,250)">vec3</span>&nbsp;MCposition;</font></p>
<p style="margin-top:0px;margin-right:0px;margin-bottom:0px;margin-left:0px;font:normal normal normal 13px/normal 'Courier New';color:rgb(210,210,210)"><font size="3"><span style="color:rgb(0,46,250)"><span>&nbsp;&nbsp; &nbsp;</span>varying</span>&nbsp;<span style="color:rgb(0,46,250)">float</span>&nbsp;LightIntensity;</font></p>
</span><span style="color:rgb(210,210,210);font-family:Courier New;line-height:normal"><span style="color:rgb(0,46,250)"><span>&nbsp;&nbsp; &nbsp;</span>uniform sampler3D</span>&nbsp;Noise;</span></font></div>
<div><font size="3"><span style="line-height:20px">
<p style="margin:0px 0px 0px 0px;font:13.0px 'Courier New';color:#d2d2d2"><span style="color:#002efa"><font size="3"><span>&nbsp; &nbsp;&nbsp;</span>if</font></span><font size="3"> (whichEffect == <span style="color:#9a1f90">4</span>)</font></p>
<p style="margin:0px 0px 0px 0px;font:13.0px 'Courier New';color:#008419"><font size="3"><span>&nbsp;&nbsp; &nbsp;</span>// old photo</font></p>
<p style="margin:0px 0px 0px 0px;font:13.0px 'Courier New';color:#d2d2d2"><font size="3"><span>&nbsp;&nbsp; &nbsp;</span>{</font></p>
<p style="margin:0px 0px 0px 0px;font:13.0px 'Courier New';color:#d2d2d2"><font size="3"><span style="white-space:pre">	</span>part = texture2DRect(whichTexture, TexCoord.xy);</font></p>
<p style="margin:0px 0px 0px 0px;font:13.0px 'Courier New';color:#d2d2d2;min-height:15.0px"><font size="3"><br>
</font></p>
<p style="margin:0px 0px 0px 0px;font:13.0px 'Courier New';color:#008419"><font size="3"><span style="color:#d2d2d2"><span style="white-space:pre">	</span></span>// original values are 1.3 0.93 4.6 3.25</font></p>
<p style="margin:0px 0px 0px 0px;font:13.0px 'Courier New';color:#008419"><font size="3"><span>&nbsp;&nbsp; &nbsp;<span>&nbsp; &nbsp; // I use 2.0 and 20.0 as radius</span></span><br>
</font></p>
<p style="margin:0px 0px 0px 0px;font:13.0px 'Courier New';color:#d2d2d2"><font size="3"><span style="white-space:pre">	</span><span style="color:#002efa">vec2</span> l1Coord = <span style="color:#002efa">vec2</span>(max(TexCoord.x - <span style="color:#9a1f90">2.0</span>, <span style="color:#9a1f90">0.0</span>), TexCoord.y);</font></p>
<p style="margin:0px 0px 0px 0px;font:13.0px 'Courier New';color:#d2d2d2"><font size="3"><span style="white-space:pre">	</span><span style="color:#002efa">vec4</span> l1 = texture2DRect(whichTexture, l1Coord);</font></p>
<p style="margin:0px 0px 0px 0px;font:13.0px 'Courier New';color:#d2d2d2"><font size="3"><span style="white-space:pre">	</span><span style="color:#002efa">vec2</span> r1Coord = <span style="color:#002efa">vec2</span>(min(TexCoord.x + <span style="color:#9a1f90">2.0</span>, <span style="color:#9a1f90">800.0</span>), TexCoord.y);</font></p>
<p style="margin:0px 0px 0px 0px;font:13.0px 'Courier New';color:#d2d2d2"><font size="3"><span style="white-space:pre">	</span><span style="color:#002efa">vec4</span> r1 = texture2DRect(whichTexture, r1Coord);</font></p>
<p style="margin:0px 0px 0px 0px;font:13.0px 'Courier New';color:#d2d2d2"><font size="3"><span style="white-space:pre">	</span><span style="color:#002efa">vec2</span> u1Coord = <span style="color:#002efa">vec2</span>(TexCoord.x, min(TexCoord.y + <span style="color:#9a1f90">2.0</span>, <span style="color:#9a1f90">800.0</span>));</font></p>
<p style="margin:0px 0px 0px 0px;font:13.0px 'Courier New';color:#d2d2d2"><font size="3"><span style="white-space:pre">	</span><span style="color:#002efa">vec4</span> u1 = texture2DRect(whichTexture, u1Coord);</font></p>
<p style="margin:0px 0px 0px 0px;font:13.0px 'Courier New';color:#d2d2d2"><font size="3"><span style="white-space:pre">	</span><span style="color:#002efa">vec2</span> b1Coord = <span style="color:#002efa">vec2</span>(TexCoord.x, max(TexCoord.y - <span style="color:#9a1f90">2.0</span>, <span style="color:#9a1f90">0.0</span>));</font></p>
<p style="margin:0px 0px 0px 0px;font:13.0px 'Courier New';color:#d2d2d2"><font size="3"><span style="white-space:pre">	</span><span style="color:#002efa">vec4</span> b1 = texture2DRect(whichTexture, b1Coord);</font></p>
<p style="margin:0px 0px 0px 0px;font:13.0px 'Courier New';color:#d2d2d2;min-height:15.0px"><span style="white-space:pre"><font size="3">	</font></span></p>
<p style="margin:0px 0px 0px 0px;font:13.0px 'Courier New';color:#d2d2d2"><font size="3"><span style="white-space:pre">	</span><span style="color:#002efa">vec2</span> ul1Coord = <span style="color:#002efa">vec2</span>(max(TexCoord.x - <span style="color:#9a1f90">1.41</span>, <span style="color:#9a1f90">0.0</span>), min(TexCoord.y + <span style="color:#9a1f90">1.41</span>, <span style="color:#9a1f90">800.0</span>));</font></p>
<p style="margin:0px 0px 0px 0px;font:13.0px 'Courier New';color:#d2d2d2"><font size="3"><span style="white-space:pre">	</span><span style="color:#002efa">vec4</span> ul1 = texture2DRect(whichTexture, ul1Coord);</font></p>
<p style="margin:0px 0px 0px 0px;font:13.0px 'Courier New';color:#d2d2d2"><font size="3"><span style="white-space:pre">	</span><span style="color:#002efa">vec2</span> ur1Coord = <span style="color:#002efa">vec2</span>(min(TexCoord.x + <span style="color:#9a1f90">1.41</span>, <span style="color:#9a1f90">800.0</span>), min(TexCoord.y + <span style="color:#9a1f90">1.41</span>, <span style="color:#9a1f90">800.0</span>));</font></p>
<p style="margin:0px 0px 0px 0px;font:13.0px 'Courier New';color:#d2d2d2"><font size="3"><span style="white-space:pre">	</span><span style="color:#002efa">vec4</span> ur1 = texture2DRect(whichTexture, ur1Coord);</font></p>
<p style="margin:0px 0px 0px 0px;font:13.0px 'Courier New';color:#d2d2d2"><font size="3"><span style="white-space:pre">	</span><span style="color:#002efa">vec2</span> bl1Coord = <span style="color:#002efa">vec2</span>(max(TexCoord.x - <span style="color:#9a1f90">1.41</span>, <span style="color:#9a1f90">0.0</span>), max(TexCoord.y - <span style="color:#9a1f90">1.41</span>, <span style="color:#9a1f90">0.0</span>));</font></p>
<p style="margin:0px 0px 0px 0px;font:13.0px 'Courier New';color:#d2d2d2"><font size="3"><span style="white-space:pre">	</span><span style="color:#002efa">vec4</span> bl1 = texture2DRect(whichTexture, bl1Coord);</font></p>
<p style="margin:0px 0px 0px 0px;font:13.0px 'Courier New';color:#d2d2d2"><font size="3"><span style="white-space:pre">	</span><span style="color:#002efa">vec2</span> br1Coord = <span style="color:#002efa">vec2</span>(min(TexCoord.x + <span style="color:#9a1f90">1.41</span>, <span style="color:#9a1f90">800.0</span>), max(TexCoord.y - <span style="color:#9a1f90">1.41</span>, <span style="color:#9a1f90">0.0</span>));</font></p>
<p style="margin:0px 0px 0px 0px;font:13.0px 'Courier New';color:#d2d2d2"><font size="3"><span style="white-space:pre">	</span><span style="color:#002efa">vec4</span> br1 = texture2DRect(whichTexture, br1Coord);</font></p>
<p style="margin:0px 0px 0px 0px;font:13.0px 'Courier New';color:#d2d2d2;min-height:15.0px"><font size="3"><br>
</font></p>
<p style="margin:0px 0px 0px 0px;font:13.0px 'Courier New';color:#d2d2d2"><font size="3"><span style="white-space:pre">	</span><span style="color:#002efa">vec2</span> l2Coord = <span style="color:#002efa">vec2</span>(max(TexCoord.x - <span style="color:#9a1f90">20.0</span>, <span style="color:#9a1f90">0.0</span>), TexCoord.y);</font></p>
<p style="margin:0px 0px 0px 0px;font:13.0px 'Courier New';color:#d2d2d2"><font size="3"><span style="white-space:pre">	</span><span style="color:#002efa">vec4</span> l2 = texture2DRect(whichTexture, l2Coord);</font></p>
<p style="margin:0px 0px 0px 0px;font:13.0px 'Courier New';color:#d2d2d2"><font size="3"><span style="white-space:pre">	</span><span style="color:#002efa">vec2</span> r2Coord = <span style="color:#002efa">vec2</span>(min(TexCoord.x + <span style="color:#9a1f90">20.0</span>, <span style="color:#9a1f90">800.0</span>), TexCoord.y);</font></p>
<p style="margin:0px 0px 0px 0px;font:13.0px 'Courier New';color:#d2d2d2"><font size="3"><span style="white-space:pre">	</span><span style="color:#002efa">vec4</span> r2 = texture2DRect(whichTexture, r2Coord);</font></p>
<p style="margin:0px 0px 0px 0px;font:13.0px 'Courier New';color:#d2d2d2"><font size="3"><span style="white-space:pre">	</span><span style="color:#002efa">vec2</span> u2Coord = <span style="color:#002efa">vec2</span>(TexCoord.x, min(TexCoord.y + <span style="color:#9a1f90">20.0</span>, <span style="color:#9a1f90">800.0</span>));</font></p>
<p style="margin:0px 0px 0px 0px;font:13.0px 'Courier New';color:#d2d2d2"><font size="3"><span style="white-space:pre">	</span><span style="color:#002efa">vec4</span> u2 = texture2DRect(whichTexture, u2Coord);</font></p>
<p style="margin:0px 0px 0px 0px;font:13.0px 'Courier New';color:#d2d2d2"><font size="3"><span style="white-space:pre">	</span><span style="color:#002efa">vec2</span> b2Coord = <span style="color:#002efa">vec2</span>(TexCoord.x, max(TexCoord.y - <span style="color:#9a1f90">20.0</span>, <span style="color:#9a1f90">0.0</span>));</font></p>
<p style="margin:0px 0px 0px 0px;font:13.0px 'Courier New';color:#d2d2d2"><font size="3"><span style="white-space:pre">	</span><span style="color:#002efa">vec4</span> b2 = texture2DRect(whichTexture, b2Coord);</font></p>
<p style="margin:0px 0px 0px 0px;font:13.0px 'Courier New';color:#d2d2d2;min-height:15.0px"><font size="3"><br>
</font></p>
<p style="margin:0px 0px 0px 0px;font:13.0px 'Courier New';color:#d2d2d2"><font size="3"><span style="white-space:pre">	</span><span style="color:#002efa">vec2</span> ul2Coord = <span style="color:#002efa">vec2</span>(max(TexCoord.x - <span style="color:#9a1f90">14.0</span>, <span style="color:#9a1f90">0.0</span>), min(TexCoord.y + <span style="color:#9a1f90">14.0</span>, <span style="color:#9a1f90">800.0</span>));</font></p>
<p style="margin:0px 0px 0px 0px;font:13.0px 'Courier New';color:#d2d2d2"><font size="3"><span style="white-space:pre">	</span><span style="color:#002efa">vec4</span> ul2 = texture2DRect(whichTexture, ul2Coord);</font></p>
<p style="margin:0px 0px 0px 0px;font:13.0px 'Courier New';color:#d2d2d2"><font size="3"><span style="white-space:pre">	</span><span style="color:#002efa">vec2</span> ur2Coord = <span style="color:#002efa">vec2</span>(min(TexCoord.x + <span style="color:#9a1f90">14.0</span>, <span style="color:#9a1f90">800.0</span>), min(TexCoord.y + <span style="color:#9a1f90">14.0</span>, <span style="color:#9a1f90">800.0</span>));</font></p>
<p style="margin:0px 0px 0px 0px;font:13.0px 'Courier New';color:#d2d2d2"><font size="3"><span style="white-space:pre">	</span><span style="color:#002efa">vec4</span> ur2 = texture2DRect(whichTexture, ur2Coord);</font></p>
<p style="margin:0px 0px 0px 0px;font:13.0px 'Courier New';color:#d2d2d2"><font size="3"><span style="white-space:pre">	</span><span style="color:#002efa">vec2</span> bl2Coord = <span style="color:#002efa">vec2</span>(max(TexCoord.x - <span style="color:#9a1f90">14.0</span>, <span style="color:#9a1f90">0.0</span>), max(TexCoord.y - <span style="color:#9a1f90">14.0</span>, <span style="color:#9a1f90">0.0</span>));</font></p>
<p style="margin:0px 0px 0px 0px;font:13.0px 'Courier New';color:#d2d2d2"><font size="3"><span style="white-space:pre">	</span><span style="color:#002efa">vec4</span> bl2 = texture2DRect(whichTexture, bl2Coord);</font></p>
<p style="margin:0px 0px 0px 0px;font:13.0px 'Courier New';color:#d2d2d2"><font size="3"><span style="white-space:pre">	</span><span style="color:#002efa">vec2</span> br2Coord = <span style="color:#002efa">vec2</span>(min(TexCoord.x + <span style="color:#9a1f90">14.0</span>, <span style="color:#9a1f90">800.0</span>), max(TexCoord.y - <span style="color:#9a1f90">14.0</span>, <span style="color:#9a1f90">0.0</span>));</font></p>
<p style="margin:0px 0px 0px 0px;font:13.0px 'Courier New';color:#d2d2d2"><font size="3"><span style="white-space:pre">	</span><span style="color:#002efa">vec4</span> br2 = texture2DRect(whichTexture, br2Coord);</font></p>
<p style="margin:0px 0px 0px 0px;font:13.0px 'Courier New';color:#d2d2d2;min-height:15.0px"><font size="3"><br>
</font></p>
<p style="margin:0px 0px 0px 0px;font:13.0px 'Courier New';color:#d2d2d2"><font size="3"><span style="white-space:pre">	</span>part = part + l1 + r1 + u1 + b1</font></p>
<p style="margin:0px 0px 0px 0px;font:13.0px 'Courier New';color:#d2d2d2"><font size="3"><span style="white-space:pre">	</span>+ ul1 + ur1 + br1 + bl1</font></p>
<p style="margin:0px 0px 0px 0px;font:13.0px 'Courier New';color:#d2d2d2"><font size="3"><span style="white-space:pre">	</span> + (l2 + r2 + u2 + b2 + ur2 + ul2 + bl2 + br2);</font></p>
<p style="margin:0px 0px 0px 0px;font:13.0px 'Courier New';color:#d2d2d2;min-height:15.0px"><font size="3"><br>
</font></p>
<p style="margin:0px 0px 0px 0px;font:13.0px 'Courier New';color:#d2d2d2"><font size="3"><span style="white-space:pre">	</span>part = part / <span style="color:#9a1f90">17.0</span>;</font></p>
<p style="margin:0px 0px 0px 0px;font:13.0px 'Courier New';color:#d2d2d2;min-height:15.0px"><font size="3"><br>
</font></p>
<p style="margin:0px 0px 0px 0px;font:13.0px 'Courier New';color:#008419"><font size="3"><span style="color:#d2d2d2"><span style="white-space:pre">	</span></span>// luminance</font></p>
<p style="margin:0px 0px 0px 0px;font:13.0px 'Courier New';color:#d2d2d2"><font size="3"><span style="white-space:pre">	</span><span style="color:#002efa">vec3</span> h = mix(<span style="color:#002efa">vec3</span>(dot(<span style="color:#002efa">vec3</span>(<span style="color:#9a1f90">0.2125</span>, <span style="color:#9a1f90">0.7154</span>, <span style="color:#9a1f90">0.0721</span>), <span style="color:#002efa">vec3</span>(part))), <span style="color:#002efa">vec3</span>(part), <span style="color:#9a1f90">0.3</span>);</font></p>
<p style="margin:0px 0px 0px 0px;font:13.0px 'Courier New';color:#008419"><font size="3"><span style="color:#d2d2d2"><span style="white-space:pre">	</span></span>//float h = 0.3 * part.r + 0.59 * part.g + 0.11 * part.b;</font></p>
<p style="margin:0px 0px 0px 0px;font:13.0px 'Courier New';color:#d2d2d2"><font size="3"><span style="white-space:pre">	</span><span style="color:#002efa">vec3</span> sepia = <span style="color:#002efa">vec3</span>(<span style="color:#9a1f90">215.0</span>, <span style="color:#9a1f90">172.0</span>, <span style="color:#9a1f90">24.0</span>) / <span style="color:#9a1f90">256.0</span>;</font></p>
<p style="margin:0px 0px 0px 0px;font:13.0px 'Courier New';color:#d2d2d2;min-height:15.0px"><font size="3"><br>
</font></p>
<p style="margin:0px 0px 0px 0px;font:13.0px 'Courier New';color:#d2d2d2"><font size="3"><span style="white-space:pre">	</span>sum = <span style="color:#002efa">vec4</span>(h * sepia, <span style="color:#9a1f90">1.0</span>);</font></p>
<p style="margin:0px 0px 0px 0px;font:13.0px 'Courier New';color:#d2d2d2;min-height:15.0px"><span style="white-space:pre"><font size="3">	</font></span></p>
<p style="margin:0px 0px 0px 0px;font:13.0px 'Courier New';color:#008419"><font size="3"><span style="color:#d2d2d2"><span style="white-space:pre">	</span></span>// resepia</font></p>
<p style="margin:0px 0px 0px 0px;font:13.0px 'Courier New';color:#008419"><font size="3"><span style="color:#d2d2d2"><span style="white-space:pre">	</span></span>//sum = vec4(mix(vec3(dot(vec3(0.2125, 0.7154, 0.0721), vec3(sum))), vec3(sum), 0.4), 1.0);</font></p>
<p style="margin:0px 0px 0px 0px;font:13.0px 'Courier New';color:#d2d2d2;min-height:15.0px"><font size="3"><br>
</font></p>
<p style="margin:0px 0px 0px 0px;font:13.0px 'Courier New';color:#008419"><font size="3"><span style="color:#d2d2d2"><span style="white-space:pre">	</span></span>//begin to deal with noise</font></p>
<p style="margin:0px 0px 0px 0px;font:13.0px 'Courier New';color:#d2d2d2;min-height:15.0px"><font size="3"><br>
</font></p>
<p style="margin:0px 0px 0px 0px;font:13.0px 'Courier New';color:#d2d2d2"><font size="3"><span style="white-space:pre">		</span><span style="color:#002efa">vec4</span> noiseVec = texture3D(Noise, MCposition);</font></p>
<p style="margin:0px 0px 0px 0px;font:13.0px 'Courier New';color:#d2d2d2"><font size="3"><span style="white-space:pre">		</span><span style="color:#002efa">vec3</span> sky = <span style="color:#002efa">vec3</span>(<span style="color:#9a1f90">0.36</span>, <span style="color:#9a1f90">0.14</span>, <span style="color:#9a1f90">0.07</span>);</font></p>
<p style="margin:0px 0px 0px 0px;font:13.0px 'Courier New';color:#d2d2d2"><font size="3"><span style="white-space:pre">		</span><span style="color:#002efa">vec3</span> cloud = <span style="color:#002efa">vec3</span>(<span style="color:#9a1f90">0.5</span>, <span style="color:#9a1f90">0.5</span>, <span style="color:#9a1f90">0.5</span>);</font></p>
<p style="margin:0px 0px 0px 0px;font:13.0px 'Courier New';color:#d2d2d2;min-height:15.0px"><font size="3"><br>
</font></p>
<p style="margin:0px 0px 0px 0px;font:13.0px 'Courier New';color:#008419"><font size="3"><span style="color:#d2d2d2"><span style="white-space:pre">		</span></span>// cloud texture</font></p>
<p style="margin:0px 0px 0px 0px;font:13.0px 'Courier New';color:#d2d2d2"><font size="3"><span style="white-space:pre">		</span><span style="color:#002efa">float</span> intensity = (noiseVec[<span style="color:#9a1f90">0</span>] + noiseVec[<span style="color:#9a1f90">1</span>] + noiseVec[<span style="color:#9a1f90">2</span>] + noiseVec[<span style="color:#9a1f90">3</span>] + <span style="color:#9a1f90">0.03125</span>) * <span style="color:#9a1f90">1.5</span>;</font></p>
<p style="margin:0px 0px 0px 0px;font:13.0px 'Courier New';color:#d2d2d2;min-height:15.0px"><font size="3"><br>
</font></p>
<p style="margin:0px 0px 0px 0px;font:13.0px 'Courier New';color:#008419"><font size="3"><span style="color:#d2d2d2"><span style="white-space:pre">		</span></span>// mix sky and cloud</font></p>
<p style="margin:0px 0px 0px 0px;font:13.0px 'Courier New';color:#d2d2d2"><font size="3"><span style="white-space:pre">		</span><span style="color:#002efa">vec3</span> scColor = mix(sky, cloud, intensity) * LightIntensity;</font></p>
<p style="margin:0px 0px 0px 0px;font:13.0px 'Courier New';color:#d2d2d2;min-height:15.0px"><span style="white-space:pre"><font size="3">	</font></span></p>
<p style="margin:0px 0px 0px 0px;font:13.0px 'Courier New';color:#008419"><font size="3"><span style="color:#d2d2d2"><span style="white-space:pre">		</span></span>// mix original and noise</font></p>
<p style="margin:0px 0px 0px 0px;font:13.0px 'Courier New';color:#d2d2d2"><font size="3"><span style="white-space:pre">		</span>sum = <span style="color:#002efa">vec4</span>(mix(scColor, <span style="color:#002efa">vec3</span>(sum), <span style="color:#9a1f90">0.5</span>), <span style="color:#9a1f90">1.0</span>);</font></p>
<p style="margin:0px 0px 0px 0px;font:13.0px 'Courier New';color:#d2d2d2;min-height:15.0px"><font size="3"><br>
</font></p>
<p style="margin:0px 0px 0px 0px;font:13.0px 'Courier New';color:#008419"><font size="3"><span style="color:#d2d2d2"><span style="white-space:pre">	</span></span>//end of noise</font></p>
<p style="margin:0px 0px 0px 0px;font:13.0px 'Courier New';color:#d2d2d2;min-height:15.0px"><font size="3"><br>
</font></p>
<p style="margin:0px 0px 0px 0px;font:13.0px 'Courier New';color:#d2d2d2"><font size="3"><span style="white-space:pre">	</span><span style="color:#002efa">if</span> (TexCoord.x &gt; <span style="color:#9a1f90">790.0</span> || TexCoord.y &gt; <span style="color:#9a1f90">790.0</span> || TexCoord.x &lt; <span style="color:#9a1f90">10.0</span> || TexCoord.y &lt;&nbsp;<span style="color:#9a1f90">10.0</span>)</font></p>
<p style="margin:0px 0px 0px 0px;font:13.0px 'Courier New';color:#d2d2d2"><font size="3"><span style="white-space:pre">		</span>sum = <span style="color:#002efa">vec4</span>(<span style="color:#9a1f90">0.8</span>, <span style="color:#9a1f90">0.8</span>, <span style="color:#9a1f90">0.8</span>, <span style="color:#9a1f90">0</span>);</font></p>
<p style="margin:0px 0px 0px 0px;font:13.0px 'Courier New';color:#d2d2d2"><font size="3"><span>&nbsp;&nbsp; &nbsp;</span>}</font></p>
</span></font></div>
<div><font size="3"><span style="line-height:20px"><br>
</span></font></div>
<div><font size="3"><span style="line-height:20px">Application code:</span></font></div>
<div><span style="line-height:20px"><font size="3">
<p style="margin:0px 0px 0px 0px;font:13.0px 'Courier New';color:#d2d2d2"><font size="3"><span style="color:#002efa"><span>&nbsp;&nbsp; &nbsp;</span>void</span> renderScene(<span style="color:#002efa">void</span>)</font></p>
<p style="margin:0px 0px 0px 0px;font:13.0px 'Courier New';color:#d2d2d2"><font size="3"><span>&nbsp;&nbsp; &nbsp;</span>{</font></p>
</font></span></div>
<div><span style="line-height:20px">
<p style="margin:0px 0px 0px 0px;font:13.0px 'Courier New';color:#d2d2d2"><font size="3"><span>&nbsp;&nbsp; &nbsp;<span>&nbsp;&nbsp; &nbsp;</span></span>GLint lightLoc, tangentLoc, noiseLoc;</font></p>
</span></div>
<div><span style="line-height:20px"><font size="3">
<p style="margin:0px 0px 0px 0px;font:13.0px 'Courier New';color:#d2d2d2"><font size="3"><span>&nbsp;&nbsp; &nbsp;<span>&nbsp;&nbsp; &nbsp;</span></span>make3DNoiseTexture();</font></p>
</font></span><span style="color:rgb(210,210,210);font-family:Courier New;line-height:normal;font-size:medium">
<div><span style="color:rgb(210,210,210);font-family:Courier New;line-height:normal;font-size:medium"><br>
</span></div>
<span>&nbsp;&nbsp; &nbsp;<span>&nbsp;&nbsp; &nbsp;</span></span>glGenTextures(<span style="color:#9a1f90">1</span>, &amp;noise3DTexName);</span><span style="line-height:20px"><font size="3">
<p style="margin:0px 0px 0px 0px;font:13.0px 'Courier New';color:#d2d2d2"><font size="3"><span>&nbsp;&nbsp; &nbsp;<span>&nbsp;&nbsp; &nbsp;</span></span>glBindTexture(GL_TEXTURE_3D, noise3DTexName);</font></p>
<p style="margin:0px 0px 0px 0px;font:13.0px 'Courier New';color:#d2d2d2"><font size="3"><br>
</font></p>
<p style="margin:0px 0px 0px 0px;font:13.0px 'Courier New';color:#d2d2d2"><font size="3"><span>&nbsp;&nbsp; &nbsp;<span>&nbsp;&nbsp; &nbsp;</span></span>glTexParameterf(GL_TEXTURE_3D, GL_TEXTURE_WRAP_S, GL_REPEAT);</font></p>
<p style="margin:0px 0px 0px 0px;font:13.0px 'Courier New';color:#d2d2d2"><font size="3"><span>&nbsp;&nbsp; &nbsp;<span>&nbsp;&nbsp; &nbsp;</span></span>glTexParameterf(GL_TEXTURE_3D, GL_TEXTURE_WRAP_T, GL_REPEAT);</font></p>
<p style="margin:0px 0px 0px 0px;font:13.0px 'Courier New';color:#d2d2d2"><font size="3"><span>&nbsp;&nbsp; &nbsp;<span>&nbsp;&nbsp; &nbsp;</span></span>glTexParameterf(GL_TEXTURE_3D, GL_TEXTURE_WRAP_R, GL_REPEAT);</font></p>
<p style="margin:0px 0px 0px 0px;font:13.0px 'Courier New';color:#d2d2d2"><font size="3"><span>&nbsp;&nbsp; &nbsp;<span>&nbsp;&nbsp; &nbsp;</span></span>glTexParameterf(GL_TEXTURE_3D, GL_TEXTURE_MAG_FILTER, GL_LINEAR);</font></p>
<p style="margin:0px 0px 0px 0px;font:13.0px 'Courier New';color:#d2d2d2"><font size="3"><span>&nbsp;&nbsp; &nbsp;<span>&nbsp;&nbsp; &nbsp;</span></span>glTexParameterf(GL_TEXTURE_3D, GL_TEXTURE_MIN_FILTER, GL_LINEAR);</font></p>
<p style="margin:0px 0px 0px 0px;font:13.0px 'Courier New';color:#d2d2d2"><font size="3"><br>
</font></p>
</font></span></div>
<div><span style="line-height:20px"><font size="3">
<p style="margin:0px 0px 0px 0px;font:13.0px 'Courier New';color:#d2d2d2"><font size="3"><span>&nbsp;&nbsp; &nbsp;<span>&nbsp;&nbsp; &nbsp;</span></span>glTexImage3D(GL_TEXTURE_3D, <span style="color:#9a1f90">0</span>, GL_RGBA,</font></p>
<p style="margin:0px 0px 0px 0px;font:13.0px 'Courier New';color:#d2d2d2"><font size="3"><span>&nbsp;&nbsp; &nbsp;<span>&nbsp;&nbsp; &nbsp;<span>&nbsp;&nbsp; &nbsp;</span></span></span>noise3DTexSize, noise3DTexSize, noise3DTexSize,&nbsp;</font></p>
<p style="margin:0px 0px 0px 0px;font:13.0px 'Courier New';color:#d2d2d2"><font size="3"><span style="color:#9a1f90"><span>&nbsp;&nbsp; &nbsp;<span>&nbsp;&nbsp; &nbsp;<span>&nbsp;&nbsp; &nbsp;</span></span></span>0</span>, GL_RGBA, GL_UNSIGNED_BYTE, noise3DTexPtr);</font></p>
<p style="margin:0px 0px 0px 0px;font:13.0px 'Courier New';color:#d2d2d2"><font size="3"><br>
</font></p>
<p style="margin:0px 0px 0px 0px;font:13.0px 'Courier New';color:#d2d2d2"><font size="3"><span>&nbsp;&nbsp; &nbsp;<span>&nbsp;&nbsp; &nbsp;</span></span>noiseLoc = glGetUniformLocation(p, <span style="color:#d867ca">"Noise"</span>);</font></p>
<p style="margin:0px 0px 0px 0px;font:13.0px 'Courier New';color:#d2d2d2"><font size="3"><span style="white-space:pre">	</span>glUniform1i(noiseLoc, <span style="color:#9a1f90">1</span>);</font></p>
<p style="margin:0px 0px 0px 0px;font:13.0px 'Courier New';color:#d2d2d2"><font size="3"><br>
</font></p>
<p style="margin:0px 0px 0px 0px;font:13.0px 'Courier New';color:#d2d2d2"><font size="3"><span>&nbsp;&nbsp; &nbsp;<span>&nbsp; &nbsp; ...</span></span><br>
</font></p>
<p style="margin:0px 0px 0px 0px;font:13.0px 'Courier New';color:#d2d2d2"><font size="3"><span>&nbsp;&nbsp; &nbsp;</span>}</font></p>
<p style="margin:0px 0px 0px 0px;font:13.0px 'Courier New';color:#d2d2d2"><font size="3"><br>
</font></p>
<p style="margin:0px 0px 0px 0px;font:13.0px 'Courier New';color:#d2d2d2"><font size="3"><span style="color:#002efa"><span>&nbsp;&nbsp; &nbsp;</span>int</span> main(<span style="color:#002efa">int</span> argc, <span style="color:#002efa">char</span> **argv)</font></p>
<p style="margin:0px 0px 0px 0px;font:13.0px 'Courier New';color:#d2d2d2"><font size="3"><span>&nbsp;&nbsp; &nbsp;</span>{</font></p>
<p style="margin:0px 0px 0px 0px;font:13.0px 'Courier New';color:#d2d2d2"><font size="3"><span>&nbsp;&nbsp; &nbsp;<span>&nbsp; &nbsp; ...</span></span><br>
</font></p>
</font></span><span style="color:rgb(210,210,210);font-family:Courier New;line-height:normal;font-size:medium"><span>&nbsp;&nbsp; &nbsp;<span>&nbsp;&nbsp; &nbsp;</span></span>glGenTextures(<span style="color:#9a1f90">1</span>, &amp;noise3DTexName);</span><span style="line-height:20px"><font size="3">
<p style="margin:0px 0px 0px 0px;font:13.0px 'Courier New';color:#d2d2d2"><font size="3"><span style="white-space:pre">	</span>glActiveTexture(GL_TEXTURE0 + <span style="color:#9a1f90">1</span>);</font></p>
<p style="margin:0px 0px 0px 0px;font:13.0px 'Courier New';color:#d2d2d2"><font size="3"><span>&nbsp;&nbsp; &nbsp;</span>}</font></p>
</font></span></div>
<div><font size="3"><span style="line-height:20px"><br>
</span></font></div>
<div><font size="3"><span style="line-height:20px">- Memo:</span></font></div>
<div><font size="3"><span style="line-height:20px">Reference:&nbsp;</span><a href="https://docs.google.com/View?id=dfmddm8t_291f6sks9cx">https://docs.google.com/View?id=dfmddm8t_291f6sks9cx</a>.</font></div>
<div><font size="3">Reference:&nbsp;</font><font size="3"><a href="http://www.ece.uic.edu/~wniedbal/cs525_project1.htm">http://www.ece.uic.edu/~wniedbal/cs525_project1.htm</a></font></div>
<div><font size="3">Reference:&nbsp;<a href="http://brianmykietka.net/projects.php?project=glsl">http://brianmykietka.net/projects.php?project=glsl</a></font>
</div>
<div><font size="3">I am not sure about the exact meaning of the description about this effect on the first link, s</font><span style="line-height:20px;font-size:medium">o I contacted Hyejung Hur, the author of this effect, to ask her about the detail of this effect,&nbsp;</span><span style="line-height:20px;font-size:medium">but I don't think I got the whole of it.</span></div>
<div><font size="3"><span style="line-height:20px">All I can present through this shader is a sepia colored blur video and some&nbsp;stain, couldn't &nbsp;get the realistic 'imprint of age</span></font><span style="line-height:20px;font-size:medium">' on it.</span></div>
<div><span style="line-height:20px;font-size:medium"><br>
</span></div>
<div><span style="line-height:20px;font-size:medium">As for the frame, I was meant to make it like </span><font size="3"><span style="line-height:20px">cinefilm as the picture below, but didn't have time to make it, so I just use a gray&nbsp;rim.</span></font></div>
<div><font size="3"><span style="line-height:20px"><br>
</span></font></div>
<div><font size="3"><span style="line-height:20px">
<div style="display:block;margin-right:auto;margin-left:auto;text-align:center"><a href="http://pic.wenwen.soso.com/p/20090508/20090508134538-1574597084.jpg" imageanchor="1"><img alt="film" border="0" height="140" src="http://pic.wenwen.soso.com/p/20090508/20090508134538-1574597084.jpg" width="320"></a></div>
<br>
</span></font></div>
<div><font size="3"><span style="line-height:20px">During making this effect, I found an interesting effect, see the <font color="#ff0000">video below</font>:</span></font></div>
<div><font size="3"><span style="line-height:20px"><br>
</span></font></div>
<div><font size="3"><span style="line-height:20px"><br>
</span></font></div>
<div><font size="3"><span style="line-height:20px">At first, I had no idea how I got this effect. After a long time of research and debugging, I found the only thing I did wrong is a&nbsp;commented function <font face="'courier new', monospace">make3DNoise()</font> in my code, which leaded to a random texture I think.</span></font></div>
<div><font size="3"><span style="line-height:20px"><br>
</span></font></div>
<div><font size="4"><u>4.5 See Me On the Teapot</u></font></div>
<div><font size="3"><br>
</font></div>
<div><font color="#ff0000" size="3">[P]</font></div>
<div><font size="3"><br>
</font></div>
<div><font size="3">- Overview:</font></div>
<div><font size="3"><span style="line-height:20px">Second page, lower right.</span></font></div>
<div><font size="3"><span style="line-height:20px">It's an <u>environment mapping</u> effect.</span></font></div>
<div><font size="3"><span style="line-height:20px"><br>
</span></font></div>
<div><font size="3"><span style="line-height:20px">- <font color="#ff0000">Principle</font>:</span></font></div>
<div><font size="3"><span style="line-height:20px"><br>
</span></font></div>
<div><font size="3"><span style="line-height:20px">- Code:</span></font></div>
<div><font size="3"><span style="line-height:20px">Vertex shader:</span></font></div>
<div><font size="3"><span style="line-height:20px">
<p style="margin:0px 0px 0px 0px;font:13.0px 'Courier New';color:#002efa"><font size="3"><span>&nbsp;&nbsp; &nbsp;</span>varying<span style="color:#d2d2d2"> </span>vec3<span style="color:#d2d2d2"> Normal;</span></font></p>
<p style="margin:0px 0px 0px 0px;font:13.0px 'Courier New';color:#002efa"><font size="3"><span>&nbsp;&nbsp; &nbsp;</span>varying<span style="color:#d2d2d2"> </span>vec3<span style="color:#d2d2d2"> EyeDir;</span></font></p>

<p style="margin:0px 0px 0px 0px;font:13.0px 'Courier New';color:#d2d2d2"><font size="3"><span style="color:#002efa"><span>&nbsp;&nbsp; &nbsp;</span>varying</span> <span style="color:#002efa">float</span> LightIntensity;</font></p>
</span>

</font></div>
<div><font size="3"><span style="line-height:20px">
<p style="margin:0px 0px 0px 0px;font:13.0px 'Courier New';color:#d2d2d2"><span style="color:#002efa"><font size="3"><span>&nbsp;&nbsp; &nbsp;</span>if</font></span><font size="3"> (whichEffect == <span style="color:#9a1f90">6</span>)</font></p>
<p style="margin:0px 0px 0px 0px;font:13.0px 'Courier New';color:#008419"><font size="3"><span>&nbsp;&nbsp; &nbsp;</span>// environment mapping</font></p>
<p style="margin:0px 0px 0px 0px;font:13.0px 'Courier New';color:#d2d2d2"><font size="3"><span>&nbsp;&nbsp; &nbsp;</span>{</font></p>
<p style="margin:0px 0px 0px 0px;font:13.0px 'Courier New';color:#d2d2d2"><font size="3"><span style="white-space:pre">	</span>Normal = normalize(gl_NormalMatrix * gl_Normal);</font></p>
<p style="margin:0px 0px 0px 0px;font:13.0px 'Courier New';color:#d2d2d2"><font size="3"><span style="white-space:pre">	</span><span style="color:#002efa">vec4</span> pos = gl_ModelViewMatrix * gl_Vertex;</font></p>
<p style="margin:0px 0px 0px 0px;font:13.0px 'Courier New';color:#d2d2d2"><font size="3"><span style="white-space:pre">	</span>EyeDir = pos.xyz;</font></p>
<p style="margin:0px 0px 0px 0px;font:13.0px 'Courier New';color:#d2d2d2"><font size="3"><span style="white-space:pre">	</span>LightIntensity = max(dot(normalize(LightPosition - EyeDir), Normal), <span style="color:#9a1f90">0.0</span>);</font></p>
<p style="margin:0px 0px 0px 0px;font:13.0px 'Courier New';color:#d2d2d2"><font size="3"><span>&nbsp;&nbsp; &nbsp;</span>}</font></p>
</span></font></div>
<div><font size="3"><span style="line-height:20px"><br>
</span></font></div>
<div><font size="3"><span style="line-height:20px">Fragment shader:
</span></font></div>
<div><font size="3"><span style="line-height:20px">
<p style="margin:0px 0px 0px 0px;font:13.0px 'Courier New';color:#d2d2d2"><font size="3"><span style="color:#002efa"><span>&nbsp;&nbsp; &nbsp;</span>uniform</span> <span style="color:#002efa">vec3</span> BaseColor;</font></p>
<p style="margin:0px 0px 0px 0px;font:13.0px 'Courier New';color:#002efa"><font size="3"><span>&nbsp;&nbsp; &nbsp;</span>uniform<span style="color:#d2d2d2"> </span>float<span style="color:#d2d2d2"> MixRatio;</span></font></p>
<p style="margin:0px 0px 0px 0px;font:13.0px 'Courier New';color:#002efa"><span style="color:#d2d2d2"><font size="3"><br>
</font></span></p>
</span></font></div>
<div><span style="line-height:20px">
<p style="margin-top:0px;margin-right:0px;margin-bottom:0px;margin-left:0px;font:normal normal normal 13px/normal 'Courier New';color:rgb(0,46,250)"><font size="3"><span>&nbsp;&nbsp; &nbsp;</span>varying<span style="color:rgb(210,210,210)">&nbsp;</span>vec3<span style="color:rgb(210,210,210)">&nbsp;Normal;</span></font></p>
<p style="font-size:medium;margin-top:0px;margin-right:0px;margin-bottom:0px;margin-left:0px;font:normal normal normal 13px/normal 'Courier New';color:rgb(0,46,250)"><font size="3"><span>&nbsp;&nbsp; &nbsp;</span>varying<span style="color:rgb(210,210,210)">&nbsp;</span>vec3<span style="color:rgb(210,210,210)">&nbsp;EyeDir;</span></font></p>
<p style="font-size:medium;margin-top:0px;margin-right:0px;margin-bottom:0px;margin-left:0px;font:normal normal normal 13px/normal 'Courier New';color:rgb(210,210,210)"><font size="3"><span style="color:rgb(0,46,250)"><span>&nbsp;&nbsp; &nbsp;</span>varying</span>&nbsp;<span style="color:rgb(0,46,250)">float</span>&nbsp;LightIntensity;</font></p>
<p style="font-size:medium;margin-top:0px;margin-right:0px;margin-bottom:0px;margin-left:0px;font:normal normal normal 13px/normal 'Courier New';color:rgb(210,210,210)"><font size="3"><br>
</font></p>
</span><span style="line-height:20px"><font size="3">
<p style="margin:0px 0px 0px 0px;font:13.0px 'Courier New';color:#d2d2d2"><font size="3"><span style="color:#002efa"><span>&nbsp;&nbsp; &nbsp;</span>if</span> (whichEffect == <span style="color:#9a1f90">6</span>)</font></p>
<p style="margin:0px 0px 0px 0px;font:13.0px 'Courier New';color:#008419"><font size="3"><span>&nbsp;&nbsp; &nbsp;</span>// environment mapping</font></p>
<p style="margin:0px 0px 0px 0px;font:13.0px 'Courier New';color:#d2d2d2"><font size="3"><span>&nbsp;&nbsp; &nbsp;</span>{</font></p>
<p style="margin:0px 0px 0px 0px;font:13.0px 'Courier New';color:#d2d2d2"><font size="3"><span style="white-space:pre">	</span><span style="color:#002efa">vec3</span> reflectDir = reflect(EyeDir, Normal);</font></p>
<p style="margin:0px 0px 0px 0px;font:13.0px 'Courier New';color:#d2d2d2;min-height:15.0px"><font size="3"><br>
</font></p>
<p style="margin:0px 0px 0px 0px;font:13.0px 'Courier New';color:#d2d2d2"><font size="3"><span style="white-space:pre">	</span><span style="color:#002efa">vec2</span> index;</font></p>
<p style="margin:0px 0px 0px 0px;font:13.0px 'Courier New';color:#d2d2d2;min-height:15.0px"><font size="3"><br>
</font></p>
<p style="margin:0px 0px 0px 0px;font:13.0px 'Courier New';color:#d2d2d2"><font size="3"><span style="white-space:pre">	</span><span style="color:#002efa">const</span> <span style="color:#002efa">vec3</span> Xunitvec = <span style="color:#002efa">vec3</span>(<span style="color:#9a1f90">1.0</span>, <span style="color:#9a1f90">0.0</span>, <span style="color:#9a1f90">0.0</span>);</font></p>
<p style="margin:0px 0px 0px 0px;font:13.0px 'Courier New';color:#d2d2d2"><font size="3"><span style="white-space:pre">	</span><span style="color:#002efa">const</span> <span style="color:#002efa">vec3</span> Yunitvec = <span style="color:#002efa">vec3</span>(<span style="color:#9a1f90">0.0</span>, <span style="color:#9a1f90">1.0</span>, <span style="color:#9a1f90">0.0</span>);</font></p>
<p style="margin:0px 0px 0px 0px;font:13.0px 'Courier New';color:#d2d2d2;min-height:15.0px"><font size="3"><br>
</font></p>
<p style="margin:0px 0px 0px 0px;font:13.0px 'Courier New';color:#d2d2d2"><font size="3"><span style="white-space:pre">	</span>index.y = dot(normalize(reflectDir), Yunitvec); &nbsp; &nbsp; &nbsp; <span style="color:#008419">// altitude</span></font></p>
<p style="margin:0px 0px 0px 0px;font:13.0px 'Courier New';color:#d2d2d2"><font size="3">&nbsp; &nbsp; <span>&nbsp;&nbsp; &nbsp;</span>reflectDir.y = <span style="color:#9a1f90">0.0</span>;</font></p>
<p style="margin:0px 0px 0px 0px;font:13.0px 'Courier New';color:#d2d2d2"><font size="3">&nbsp; &nbsp; <span>&nbsp;&nbsp; &nbsp;</span>index.x = dot(normalize(reflectDir), Xunitvec) * <span style="color:#9a1f90">0.5</span>; <span style="color:#008419">// azimuth</span></font></p>
<p style="margin:0px 0px 0px 0px;font:13.0px 'Courier New';color:#d2d2d2;min-height:15.0px"><font size="3"><br>
</font></p>
<p style="margin:0px 0px 0px 0px;font:13.0px 'Courier New';color:#008419"><font size="3"><span>&nbsp;&nbsp; &nbsp;</span>// index.x ranges from -0.5 to 0.5</font></p>
<p style="margin:0px 0px 0px 0px;font:13.0px 'Courier New';color:#008419"><font size="3"><span style="color:#d2d2d2">&nbsp; &nbsp; </span>// index.y ranges from -1 to 1</font></p>
<p style="margin:0px 0px 0px 0px;font:13.0px 'Courier New';color:#008419"><font size="3"><span style="color:#d2d2d2">&nbsp; &nbsp; </span>// texture coordinates range from 0 to 1 in both dimensions (aside from wrapping)</font></p>
<p style="margin:0px 0px 0px 0px;font:13.0px 'Courier New';color:#d2d2d2;min-height:15.0px"><font size="3"><br>
</font></p>
<p style="margin:0px 0px 0px 0px;font:13.0px 'Courier New';color:#008419"><font size="3"><span style="color:#d2d2d2">&nbsp; &nbsp; </span>// Translate index values into proper range</font></p>
<p style="margin:0px 0px 0px 0px;font:13.0px 'Courier New';color:#008419"><font size="3"><span style="color:#d2d2d2">&nbsp; &nbsp; </span>// t (elevation) value is straight forward, s (azimuth) is a bit more complicated</font></p>
<p style="margin:0px 0px 0px 0px;font:13.0px 'Courier New';color:#008419"><font size="3"><span style="color:#d2d2d2">&nbsp; &nbsp; </span>// if reflectDir.z &gt;= 0.0, s will range from 0.25 to 0.75 (front side)</font></p>
<p style="margin:0px 0px 0px 0px;font:13.0px 'Courier New';color:#008419"><font size="3"><span style="color:#d2d2d2">&nbsp; &nbsp; </span>// if reflectDir.z&nbsp; &lt; 0.0, s will range from 0.75 to 1.25 (-0.25) (back side)</font></p>
<p style="margin:0px 0px 0px 0px;font:13.0px 'Courier New';color:#008419"><font size="3"><span style="color:#d2d2d2">&nbsp; &nbsp; </span>// &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; which is OK since we are wrapping</font></p>
<p style="margin:0px 0px 0px 0px;font:13.0px 'Courier New';color:#008419"><font size="3"><span style="color:#d2d2d2">&nbsp; &nbsp; </span>// t will range from 0 to 1&nbsp;</font></p>
<p style="margin:0px 0px 0px 0px;font:13.0px 'Courier New';color:#d2d2d2;min-height:15.0px"><font size="3"><br>
</font></p>
<p style="margin:0px 0px 0px 0px;font:13.0px 'Courier New';color:#008419"><font size="3"><span style="color:#d2d2d2">&nbsp; &nbsp; <span>&nbsp;&nbsp; &nbsp;</span></span><span style="color:#002efa">if</span><span style="color:#d2d2d2"> (reflectDir.z &gt;= </span><span style="color:#9a1f90">0.0</span><span style="color:#d2d2d2">) </span>// reflecting towards the front</font></p>
<p style="margin:0px 0px 0px 0px;font:13.0px 'Courier New';color:#d2d2d2"><font size="3">&nbsp; &nbsp; &nbsp; &nbsp; <span>&nbsp;&nbsp; &nbsp;</span>index = (index + <span style="color:#9a1f90">1.0</span>) * <span style="color:#9a1f90">0.5</span>;</font></p>
<p style="margin:0px 0px 0px 0px;font:13.0px 'Courier New';color:#d2d2d2;min-height:15.0px"><font size="3"><br>
</font></p>
<p style="margin:0px 0px 0px 0px;font:13.0px 'Courier New';color:#008419"><font size="3"><span style="color:#002efa"><span>&nbsp;&nbsp; &nbsp;<span>&nbsp;&nbsp; &nbsp;</span></span>else</span><span style="color:#d2d2d2"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span>// reflecting towards the back</font></p>
<p style="margin:0px 0px 0px 0px;font:13.0px 'Courier New';color:#d2d2d2"><font size="3"><span style="white-space:pre">	</span>{</font></p>
<p style="margin:0px 0px 0px 0px;font:13.0px 'Courier New';color:#d2d2d2"><font size="3">&nbsp; &nbsp; &nbsp; &nbsp; <span>&nbsp;&nbsp; &nbsp;</span>index.s = (-index.s) * <span style="color:#9a1f90">0.5</span> + <span style="color:#9a1f90">1.0</span>;</font></p>
<p style="margin:0px 0px 0px 0px;font:13.0px 'Courier New';color:#d2d2d2"><font size="3">&nbsp; &nbsp; &nbsp; &nbsp; <span>&nbsp;&nbsp; &nbsp;</span>index.t = (index.t + <span style="color:#9a1f90">1.0</span>) * <span style="color:#9a1f90">0.5</span>; <span style="color:#008419">// same as for index.t above</span></font></p>
<p style="margin:0px 0px 0px 0px;font:13.0px 'Courier New';color:#d2d2d2"><font size="3"><span style="white-space:pre">	</span>}</font></p>
<p style="margin:0px 0px 0px 0px;font:13.0px 'Courier New';color:#d2d2d2;min-height:15.0px"><font size="3"><br>
</font></p>
<p style="margin:0px 0px 0px 0px;font:13.0px 'Courier New';color:#008419"><font size="3"><span style="color:#d2d2d2"><span style="white-space:pre">	</span></span>//change index to actual coord</font></p>
<p style="margin:0px 0px 0px 0px;font:13.0px 'Courier New';color:#d2d2d2"><font size="3"><span style="white-space:pre">	</span>index = index * <span style="color:#9a1f90">800.0</span>;</font></p>
<p style="margin:0px 0px 0px 0px;font:13.0px 'Courier New';color:#d2d2d2"><font size="3"><span style="white-space:pre">	</span>index.t = <span style="color:#9a1f90">800.0</span> - index.t;</font></p>
<p style="margin:0px 0px 0px 0px;font:13.0px 'Courier New';color:#d2d2d2;min-height:15.0px"><font size="3"><br>
</font></p>
<p style="margin:0px 0px 0px 0px;font:13.0px 'Courier New';color:#008419"><font size="3"><span style="color:#d2d2d2">&nbsp; &nbsp; </span>// Do a lookup into the environment map</font></p>
<p style="margin:0px 0px 0px 0px;font:13.0px 'Courier New';color:#d2d2d2"><font size="3">&nbsp; &nbsp; <span>&nbsp;&nbsp; &nbsp;</span><span style="color:#002efa">vec3</span> envColor = <span style="color:#002efa">vec3</span> (texture2DRect(whichTexture, index));</font></p>
<p style="margin:0px 0px 0px 0px;font:13.0px 'Courier New';color:#d2d2d2;min-height:15.0px"><font size="3"><br>
</font></p>
<p style="margin:0px 0px 0px 0px;font:13.0px 'Courier New';color:#008419"><font size="3"><span style="color:#d2d2d2">&nbsp; &nbsp; </span>// Add lighting to base colour and mix</font></p>
<p style="margin:0px 0px 0px 0px;font:13.0px 'Courier New';color:#d2d2d2"><font size="3">&nbsp; &nbsp; <span>&nbsp;&nbsp; &nbsp;</span><span style="color:#002efa">vec3</span> base = LightIntensity * BaseColor;</font></p>
<p style="margin:0px 0px 0px 0px;font:13.0px 'Courier New';color:#d2d2d2"><font size="3">&nbsp; &nbsp; <span>&nbsp;&nbsp; &nbsp;</span>envColor = mix(envColor, base, MixRatio);</font></p>
<p style="margin:0px 0px 0px 0px;font:13.0px 'Courier New';color:#d2d2d2;min-height:15.0px"><font size="3"><br>
</font></p>
<p style="margin:0px 0px 0px 0px;font:13.0px 'Courier New';color:#d2d2d2"><font size="3">&nbsp; &nbsp; <span>&nbsp;&nbsp; &nbsp;</span>sum = <span style="color:#002efa">vec4</span>(envColor, <span style="color:#9a1f90">1.0</span>);</font></p>
<p style="margin:0px 0px 0px 0px;font:13.0px 'Courier New';color:#d2d2d2"><font size="3">}</font></p>
</font></span></div>
<div><font size="3"><span style="line-height:20px"><br>
</span></font></div>
<div><font size="3"><span style="line-height:20px">Application code:</span></font></div>
<div><font size="3"><span style="line-height:20px">
<p style="margin-top:0px;margin-right:0px;margin-bottom:0px;margin-left:0px;font:normal normal normal 13px/normal 'Courier New';color:rgb(210,210,210)"><font size="3"><span style="color:rgb(0,46,250)"><span>&nbsp;&nbsp; &nbsp;</span>void</span> renderScene(<span style="color:rgb(0,46,250)">void</span>)</font></p>
</span><span style="color:rgb(210,210,210);font-family:Courier New;line-height:normal"><span>&nbsp;&nbsp; &nbsp;</span>{</span></font><span style="line-height:20px">
<p style="margin-top:0px;margin-right:0px;margin-bottom:0px;margin-left:0px;font:normal normal normal 13px/normal 'Courier New';color:rgb(210,210,210)"><font size="3"><span><span><span>&nbsp;&nbsp; &nbsp;<span>&nbsp;&nbsp; &nbsp;</span></span>...</span></span><br>
</font></p>
<p style="margin-top:0px;margin-right:0px;margin-bottom:0px;margin-left:0px;font:normal normal normal 13px/normal 'Courier New';color:rgb(210,210,210)"><span><span><font size="3"><br>
</font></span></span></p>
<p style="margin-top:0px;margin-right:0px;margin-bottom:0px;margin-left:0px;font:normal normal normal 13px/normal 'Courier New';color:rgb(0,132,25)"><font size="3"><span style="color:#d2d2d2"><span style="white-space:pre">	</span></span>// draw lower right image - Shi</font></p>
<p style="margin-top:0px;margin-right:0px;margin-bottom:0px;margin-left:0px;font:normal normal normal 13px/normal 'Courier New';color:rgb(210,210,210)"><font size="3"><span style="white-space:pre">	</span><span style="color:#002efa">if</span> (mode == <span style="color:#e51e12">'s'</span>)</font></p>
<p style="margin-top:0px;margin-right:0px;margin-bottom:0px;margin-left:0px;font:normal normal normal 13px/normal 'Courier New';color:rgb(210,210,210)"><font size="3"><span style="white-space:pre">	</span>{</font></p>
<p style="margin-top:0px;margin-right:0px;margin-bottom:0px;margin-left:0px;font:normal normal normal 13px/normal 'Courier New';color:rgb(210,210,210);min-height:15px"><span style="white-space:pre"><font size="3">		</font></span></p>
<p style="margin-top:0px;margin-right:0px;margin-bottom:0px;margin-left:0px;font:normal normal normal 13px/normal 'Courier New';color:rgb(210,210,210)"><font size="3"><span style="color:#002efa"><span>&nbsp;&nbsp; &nbsp;<span>&nbsp;&nbsp; &nbsp;<span>&nbsp;&nbsp; &nbsp;</span></span></span>if</span> (currentWindow == <span style="color:#9a1f90">1</span>)</font></p>
<p style="margin-top:0px;margin-right:0px;margin-bottom:0px;margin-left:0px;font:normal normal normal 13px/normal 'Courier New';color:rgb(0,132,25)"><font size="3"><span style="color:#d2d2d2"><span style="white-space:pre">	<span>&nbsp;&nbsp; &nbsp;</span></span></span>// draw environment mapping - Shi</font></p>
<p style="margin-top:0px;margin-right:0px;margin-bottom:0px;margin-left:0px;font:normal normal normal 13px/normal 'Courier New';color:rgb(210,210,210)"><font size="3"><span style="white-space:pre">	<span>&nbsp;&nbsp; &nbsp;</span></span>{</font></p>
<p style="margin-top:0px;margin-right:0px;margin-bottom:0px;margin-left:0px;font:normal normal normal 13px/normal 'Courier New';color:rgb(210,210,210)"><font size="3"><span>&nbsp;&nbsp; &nbsp;<span>&nbsp;&nbsp; &nbsp;<span>&nbsp;&nbsp; &nbsp;<span>&nbsp;&nbsp; &nbsp;</span></span></span></span>gluLookAt(<span style="color:#9a1f90">0.0</span>,<span style="color:#9a1f90">3.0</span>,<span style="color:#9a1f90">6.0</span>,&nbsp;</font></p>
<p style="margin-top:0px;margin-right:0px;margin-bottom:0px;margin-left:0px;font:normal normal normal 13px/normal 'Courier New';color:rgb(210,210,210)"><font size="3"><span style="color:#9a1f90"><span>&nbsp;&nbsp; &nbsp;<span>&nbsp;&nbsp; &nbsp;<span>&nbsp;&nbsp; &nbsp;<span>&nbsp;&nbsp; &nbsp;<span>&nbsp;&nbsp; &nbsp;</span></span></span></span></span>0.0</span>,<span style="color:#9a1f90">0.0</span>,-<span style="color:#9a1f90">1.0</span>,</font></p>
<p style="margin-top:0px;margin-right:0px;margin-bottom:0px;margin-left:0px;font:normal normal normal 13px/normal 'Courier New';color:rgb(154,31,144)"><font size="3"><span>&nbsp;&nbsp; &nbsp;<span>&nbsp;&nbsp; &nbsp;<span>&nbsp;&nbsp; &nbsp;<span>&nbsp;&nbsp; &nbsp;<span>&nbsp;&nbsp; &nbsp;</span></span></span></span></span>0.0f<span style="color:#d2d2d2">,</span>1.0f<span style="color:#d2d2d2">,</span>0.0f<span style="color:#d2d2d2">);</span></font></p>
<p style="margin-top:0px;margin-right:0px;margin-bottom:0px;margin-left:0px;font:normal normal normal 13px/normal 'Courier New';color:rgb(210,210,210)"><font size="3"><span>&nbsp;&nbsp; &nbsp;<span>&nbsp;&nbsp; &nbsp;<span>&nbsp;&nbsp; &nbsp;<span>&nbsp;&nbsp; &nbsp;</span></span></span></span>effectLoc = glGetUniformLocation(p, <span style="color:#d867ca">"whichEffect"</span>);</font></p>
<p style="margin-top:0px;margin-right:0px;margin-bottom:0px;margin-left:0px;font:normal normal normal 13px/normal 'Courier New';color:rgb(210,210,210)"><font size="3"><span style="white-space:pre">	<span>&nbsp;&nbsp; &nbsp;<span>&nbsp;&nbsp; &nbsp;</span></span></span>glUniform1i(effectLoc, <span style="color:#9a1f90">6</span>);</font></p>
<p style="margin-top:0px;margin-right:0px;margin-bottom:0px;margin-left:0px;font:normal normal normal 13px/normal 'Courier New';color:rgb(210,210,210);min-height:15px"><font size="3"><br>
</font></p>
<p style="margin-top:0px;margin-right:0px;margin-bottom:0px;margin-left:0px;font:normal normal normal 13px/normal 'Courier New';color:rgb(0,132,25)"><font size="3"><span style="color:#d2d2d2"><span style="white-space:pre">	<span>&nbsp;&nbsp; &nbsp;<span>&nbsp;&nbsp; &nbsp;</span></span></span></span>//glRotatef(rotAmount, 0, 1, 0);</font></p>
<p style="margin-top:0px;margin-right:0px;margin-bottom:0px;margin-left:0px;font:normal normal normal 13px/normal 'Courier New';color:rgb(210,210,210);min-height:15px"><font size="3"><br>
</font></p>
<p style="margin-top:0px;margin-right:0px;margin-bottom:0px;margin-left:0px;font:normal normal normal 13px/normal 'Courier New';color:rgb(210,210,210)"><font size="3"><span style="white-space:pre">	<span>&nbsp;&nbsp; &nbsp;<span>&nbsp;&nbsp; &nbsp;</span></span></span>glRotatef(mouseWindowX*<span style="color:#9a1f90">90</span>+<span style="color:#9a1f90">90</span>,<span style="color:#9a1f90">0</span>,<span style="color:#9a1f90">1</span>,<span style="color:#9a1f90">0</span>);</font></p>
<p style="margin-top:0px;margin-right:0px;margin-bottom:0px;margin-left:0px;font:normal normal normal 13px/normal 'Courier New';color:rgb(210,210,210)"><font size="3"><span style="white-space:pre">	<span>&nbsp;&nbsp; &nbsp;<span>&nbsp;&nbsp; &nbsp;</span></span></span>glRotatef(mouseWindowY*<span style="color:#9a1f90">90</span>,<span style="color:#9a1f90">0</span>,<span style="color:#9a1f90">0</span>,<span style="color:#9a1f90">1</span>);</font></p>
<p style="margin-top:0px;margin-right:0px;margin-bottom:0px;margin-left:0px;font:normal normal normal 13px/normal 'Courier New';color:rgb(210,210,210);min-height:15px"><font size="3"><br>
</font></p>
<p style="margin-top:0px;margin-right:0px;margin-bottom:0px;margin-left:0px;font:normal normal normal 13px/normal 'Courier New';color:rgb(210,210,210)"><font size="3"><span style="white-space:pre">	<span>&nbsp;&nbsp; &nbsp;<span>&nbsp;&nbsp; &nbsp;</span></span></span>glutSolidTeapot(<span style="color:#9a1f90">1</span>);</font></p>
<p style="margin-top:0px;margin-right:0px;margin-bottom:0px;margin-left:0px;font:normal normal normal 13px/normal 'Courier New';color:rgb(210,210,210)"><font size="3"><span style="white-space:pre">	<span>&nbsp;&nbsp; &nbsp;</span></span>}</font></p>
<p style="margin-top:0px;margin-right:0px;margin-bottom:0px;margin-left:0px;font:normal normal normal 13px/normal 'Courier New';color:rgb(210,210,210)"><font size="3"><span>&nbsp;&nbsp; &nbsp;<span>&nbsp;&nbsp; &nbsp;<span>&nbsp;&nbsp; &nbsp;</span><span><span>...</span></span></span></span></font></p>
<p style="margin-top:0px;margin-right:0px;margin-bottom:0px;margin-left:0px;font:normal normal normal 13px/normal 'Courier New';color:rgb(210,210,210)"><font size="3"><span><span><span><span><span>&nbsp;&nbsp; &nbsp;<span>&nbsp;&nbsp; &nbsp;</span></span>}</span></span></span></span></font></p>
<p style="margin-top:0px;margin-right:0px;margin-bottom:0px;margin-left:0px;font:normal normal normal 13px/normal 'Courier New';color:rgb(210,210,210)"><font size="3"><span><span><span><span><br>
</span></span></span></span></font></p>
<p style="margin-top:0px;margin-right:0px;margin-bottom:0px;margin-left:0px;font:normal normal normal 13px/normal 'Courier New';color:rgb(210,210,210)"><font size="3"><span><span><span><span><span>&nbsp;&nbsp; &nbsp;<span>&nbsp; &nbsp; ...</span></span><br>
</span></span></span></span></font></p>
<p style="margin-top:0px;margin-right:0px;margin-bottom:0px;margin-left:0px;font:normal normal normal 13px/normal 'Courier New';color:rgb(210,210,210);min-height:15px"><font size="3"><br>
</font></p>
<p style="margin-top:0px;margin-right:0px;margin-bottom:0px;margin-left:0px;font:normal normal normal 13px/normal 'Courier New';color:rgb(210,210,210)"><font size="3"><span style="white-space:pre">	</span>glutSwapBuffers();</font></p>
<p style="margin-top:0px;margin-right:0px;margin-bottom:0px;margin-left:0px;font:normal normal normal 13px/normal 'Courier New';color:rgb(210,210,210)"><font size="3"><span>&nbsp;&nbsp; &nbsp;</span>}</font></p>
<div><br>
</div>
</span></div>
<div><font size="3"><span style="line-height:20px"><br>
</span></font></div>
<div><font size="3"><span style="line-height:20px">- Memo:</span></font></div>
<div><font size="3"><span style="line-height:20px">Reference: course note.</span></font></div>
<div><span style="line-height:20px;font-size:medium">This effect can only be seen in fullscreen mode; it doesn't display properly when in overview mode.</span></div>
<div><font size="3"><span style="line-height:20px"><br>
</span></font></div>
<div><font size="4"><u>4.6 Spring Bump Festival</u></font></div>
<div><font size="3"><br>
</font></div>
<div><font size="3">- Overview:</font></div>
<div><font size="3">Second page, upper right.</font></div>
<div><font size="3">It's a <u>bump mapping</u> effect.</font></div>
<div><font size="3"><span style="line-height:20px"><br>
</span></font></div>
<div><font color="#ffff00" size="3"><span style="line-height:20px">- Principle:</span></font></div>
<div><font size="3"><span style="line-height:20px">The goal is to draw 8 columns of lanterns, each containing 16 of them.</span></font></div>
<div><font size="3"><span style="line-height:20px">Calculate new normals for each pixel procedurally using pre-defined math functions, then apply lighting using computed normals value.</span></font></div>
<div><font size="3"><span style="line-height:20px"><br>
</span></font></div>
<div><font size="3"><span style="line-height:20px">- Code:</span></font></div>
<div><font size="3"><span style="line-height:20px">Vertex shader:</span></font></div>
<div><font size="3"><span style="line-height:20px">
<p style="margin:0px 0px 0px 0px;font:13.0px 'Courier New';color:#d2d2d2"><font size="3"><span style="color:#002efa"><span>&nbsp;&nbsp; &nbsp;</span>uniform</span> <span style="color:#002efa">vec3</span> LightPosition;</font></p>
<p style="margin:0px 0px 0px 0px;font:13.0px 'Courier New';color:#002efa"><font size="3"><span>&nbsp;&nbsp; &nbsp;</span>varying<span style="color:#d2d2d2"> </span>vec3<span style="color:#d2d2d2"> EyeDir;</span></font></p>
<p style="margin:0px 0px 0px 0px;font:13.0px 'Courier New';color:#002efa"><font size="3"><span>&nbsp;&nbsp; &nbsp;</span>varying<span style="color:#d2d2d2"> </span>vec3<span style="color:#d2d2d2"> LightDir;</span></font></p>
</span>
<p style="margin:0px 0px 0px 0px;font:13.0px 'Courier New';color:#002efa"><font size="3"><span>&nbsp;&nbsp; &nbsp;</span>attribute<span style="color:#d2d2d2"> </span>vec3<span style="color:#d2d2d2"> Tangent;</span></font></p>
<p style="margin:0px 0px 0px 0px;font:13.0px 'Courier New';color:#002efa"><span style="color:#d2d2d2"><br>
</span></p>
</font></div>
<div><font size="3"><span style="line-height:20px">
<p style="margin:0px 0px 0px 0px;font:13.0px 'Courier New';color:#d2d2d2"><font size="3"><span style="color:#002efa"><span>&nbsp;&nbsp; &nbsp;</span>if</span> (whichEffect == <span style="color:#9a1f90">7</span>)</font></p>
<p style="margin-top:0px;margin-right:0px;margin-bottom:0px;margin-left:0px;font:normal normal normal 13px/normal 'Courier New'"><font size="3"><font color="#008419"><span>&nbsp;&nbsp; &nbsp;</span>// bump mapping</font></font></p>
<p style="margin:0px 0px 0px 0px;font:13.0px 'Courier New';color:#d2d2d2"><font size="3"><span>&nbsp;&nbsp; &nbsp;</span>{</font></p>
<p style="margin:0px 0px 0px 0px;font:13.0px 'Courier New';color:#d2d2d2"><font size="3"><span>&nbsp;&nbsp; &nbsp;<span>&nbsp;&nbsp; &nbsp;</span></span>EyeDir = <span style="color:#002efa">vec3</span>(gl_ModelViewMatrix * gl_Vertex);</font></p>
<p style="margin:0px 0px 0px 0px;font:13.0px 'Courier New';color:#d2d2d2;min-height:15.0px"><font size="3"><br>
</font></p>
<p style="margin:0px 0px 0px 0px;font:13.0px 'Courier New';color:#008419"><font size="3"><span>&nbsp;&nbsp; &nbsp;<span>&nbsp;&nbsp; &nbsp;</span></span>// compute normal and tangent and binormal</font></p>
<p style="margin:0px 0px 0px 0px;font:13.0px 'Courier New';color:#d2d2d2"><font size="3"><span style="white-space:pre">	</span><span style="color:#002efa">vec3</span> n = normalize(gl_NormalMatrix * gl_Normal);</font></p>
<p style="margin:0px 0px 0px 0px;font:13.0px 'Courier New';color:#d2d2d2"><font size="3"><span style="white-space:pre">	</span><span style="color:#002efa">vec3</span> t = normalize(gl_NormalMatrix * Tangent);</font></p>
<p style="margin:0px 0px 0px 0px;font:13.0px 'Courier New';color:#d2d2d2"><font size="3"><span style="white-space:pre">	</span><span style="color:#002efa">vec3</span> b = cross(n, t);</font></p>
<p style="margin:0px 0px 0px 0px;font:13.0px 'Courier New';color:#d2d2d2;min-height:15.0px"><font size="3"><br>
</font></p>
<p style="margin:0px 0px 0px 0px;font:13.0px 'Courier New';color:#008419"><font size="3"><span style="color:#d2d2d2"><span style="white-space:pre">	</span></span>// convert light direction from eye space to tangent space</font></p>
<p style="margin:0px 0px 0px 0px;font:13.0px 'Courier New';color:#d2d2d2"><font size="3"><span style="white-space:pre">	</span><span style="color:#002efa">vec3</span> v;</font></p>
<p style="margin:0px 0px 0px 0px;font:13.0px 'Courier New';color:#d2d2d2"><font size="3"><span style="white-space:pre">	</span>v.x = dot(LightPosition, t);</font></p>
<p style="margin:0px 0px 0px 0px;font:13.0px 'Courier New';color:#d2d2d2"><font size="3"><span style="white-space:pre">	</span>v.y = dot(LightPosition, b);</font></p>
<p style="margin:0px 0px 0px 0px;font:13.0px 'Courier New';color:#d2d2d2"><font size="3"><span style="white-space:pre">	</span>v.z = dot(LightPosition, n);</font></p>
<p style="margin:0px 0px 0px 0px;font:13.0px 'Courier New';color:#d2d2d2"><font size="3"><span style="white-space:pre">	</span>LightDir = normalize(v);</font></p>
<p style="margin:0px 0px 0px 0px;font:13.0px 'Courier New';color:#d2d2d2;min-height:15.0px"><font size="3"><br>
</font></p>
<p style="margin:0px 0px 0px 0px;font:13.0px 'Courier New';color:#008419"><font size="3"><span style="color:#d2d2d2"><span style="white-space:pre">	</span></span>// convert eye direction from eye space to tangent space</font></p>
<p style="margin:0px 0px 0px 0px;font:13.0px 'Courier New';color:#d2d2d2"><font size="3"><span style="white-space:pre">	</span>v.x = dot(EyeDir, t);</font></p>
<p style="margin:0px 0px 0px 0px;font:13.0px 'Courier New';color:#d2d2d2"><font size="3"><span style="white-space:pre">	</span>v.y = dot(EyeDir, b);</font></p>
<p style="margin:0px 0px 0px 0px;font:13.0px 'Courier New';color:#d2d2d2"><font size="3"><span style="white-space:pre">	</span>v.z = dot(EyeDir, n);</font></p>
<p style="margin:0px 0px 0px 0px;font:13.0px 'Courier New';color:#d2d2d2"><font size="3"><span style="white-space:pre">	</span>EyeDir = normalize(v);</font></p>
<p style="margin:0px 0px 0px 0px;font:13.0px 'Courier New';color:#d2d2d2"><font size="3"><span>&nbsp;&nbsp; &nbsp;</span>}</font></p>
<p style="margin:0px 0px 0px 0px;font:13.0px 'Courier New';color:#d2d2d2"><br>
</p>
</span></font></div>
<div><font size="3"><span style="line-height:20px">Fragment shader:</span></font></div>
<div><font size="3"><span style="line-height:20px">
<p style="margin-top:0px;margin-right:0px;margin-bottom:0px;margin-left:0px;font:normal normal normal 13px/normal 'Courier New';color:rgb(0,46,250)"><font size="3"><span>&nbsp; &nbsp;&nbsp;</span>varying<span style="color:rgb(210,210,210)">&nbsp;</span>vec3<span style="color:rgb(210,210,210)">&nbsp;EyeDir;</span></font></p>
<p style="margin-top:0px;margin-right:0px;margin-bottom:0px;margin-left:0px;font:normal normal normal 13px/normal 'Courier New';color:rgb(0,46,250)"><font size="3"><span>&nbsp;&nbsp; &nbsp;</span>varying<span style="color:rgb(210,210,210)">&nbsp;</span>vec3<span style="color:rgb(210,210,210)">&nbsp;LightDir;</span></font></p>
</span></font></div>
<div><font size="3"><span style="line-height:20px">
<p style="margin:0px 0px 0px 0px;font:13.0px 'Courier New';color:#d2d2d2"><font size="3"><span style="color:#002efa"><span>&nbsp;&nbsp; &nbsp;</span>if</span> (whichEffect == <span style="color:#9a1f90">7</span>)</font></p>
<p style="margin:0px 0px 0px 0px;font:13.0px 'Courier New';color:#008419"><font size="3"><span>&nbsp;&nbsp; &nbsp;</span>// bump mapping</font></p>
<p style="margin:0px 0px 0px 0px;font:13.0px 'Courier New';color:#d2d2d2"><font size="3"><span>&nbsp;&nbsp; &nbsp;</span>{</font></p>
<p style="margin:0px 0px 0px 0px;font:13.0px 'Courier New';color:#d2d2d2"><font size="3"><span style="white-space:pre">	</span>part = texture2DRect(whichTexture, TexCoord.xy);</font></p>
<p style="margin:0px 0px 0px 0px;font:13.0px 'Courier New';color:#d2d2d2"><font size="3"><br>
</font></p>
<p style="margin:0px 0px 0px 0px;font:13.0px 'Courier New';color:#008419"><font size="3"><span>&nbsp;&nbsp; &nbsp;<span>&nbsp;&nbsp; &nbsp;</span></span>// changed the parameters</font></p>
<p style="margin:0px 0px 0px 0px;font:13.0px 'Courier New';color:#d2d2d2"><font size="3"><span style="white-space:pre">	</span><span style="color:#002efa">vec2</span> BumpDensity = <span style="color:#002efa">vec2</span>(<span style="color:#9a1f90">8.0</span>, <span style="color:#9a1f90">16.0</span>);</font></p>
<p style="margin:0px 0px 0px 0px;font:13.0px 'Courier New';color:#d2d2d2"><font size="3"><span style="white-space:pre">	</span><span style="color:#002efa">float</span> BumpSize&nbsp; &nbsp; = <span style="color:#9a1f90">0.1</span>;</font></p>
<p style="margin:0px 0px 0px 0px;font:13.0px 'Courier New';color:#d2d2d2"><font size="3"><span style="white-space:pre">	</span><span style="color:#002efa">float</span> SpecularFactor = <span style="color:#9a1f90">0.5</span>;</font></p>
<p style="margin:0px 0px 0px 0px;font:13.0px 'Courier New';color:#d2d2d2;min-height:15.0px"><font size="3"><br>
</font></p>
<p style="margin:0px 0px 0px 0px;font:13.0px 'Courier New';color:#d2d2d2"><font size="3"><span style="white-space:pre">	</span><span style="color:#002efa">vec3</span> litColor;</font></p>
<p style="margin:0px 0px 0px 0px;font:13.0px 'Courier New';color:#d2d2d2"><font size="3"><span style="color:#002efa"><span>&nbsp;&nbsp; &nbsp;<span>&nbsp;&nbsp; &nbsp;</span></span>vec2</span> c = BumpDensity * <span style="color:#002efa">vec2</span>(TexCoord.st / <span style="color:#9a1f90">800.0</span>); <span style="color:#008419">// bump number</span></font></p>
<p style="margin:0px 0px 0px 0px;font:13.0px 'Courier New';color:#008419"><font size="3"><span style="color:#002efa"><span>&nbsp;&nbsp; &nbsp;<span>&nbsp;&nbsp; &nbsp;</span></span>vec2</span><span style="color:#d2d2d2"> p = fract(c) - </span><span style="color:#002efa">vec2</span><span style="color:#d2d2d2"> (</span><span style="color:#9a1f90">0.5</span><span style="color:#d2d2d2">); </span>// angle of normal changing over the bump area</font></p>
<p style="margin:0px 0px 0px 0px;font:13.0px 'Courier New';color:#d2d2d2;min-height:15.0px"><font size="3">&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</font></p>
<p style="margin:0px 0px 0px 0px;font:13.0px 'Courier New';color:#008419"><font size="3"><span style="color:#d2d2d2"><span style="white-space:pre">	</span>p.y /= </span><span style="color:#9a1f90">2.0</span><span style="color:#d2d2d2">; </span>//p.y ranges from -0.25 to 0.25 for each bump</font></p>
<p style="margin:0px 0px 0px 0px;font:13.0px 'Courier New';color:#d2d2d2;min-height:15.0px"><span style="white-space:pre"><font size="3">	</font></span></p>
<p style="margin:0px 0px 0px 0px;font:13.0px 'Courier New';color:#d2d2d2"><font size="3">&nbsp; &nbsp; <span>&nbsp;&nbsp; &nbsp;</span><span style="color:#002efa">float</span> d, f;</font></p>
<p style="margin:0px 0px 0px 0px;font:13.0px 'Courier New';color:#008419"><font size="3"><span style="color:#d2d2d2">&nbsp; &nbsp; <span>&nbsp;&nbsp; &nbsp;</span>d = p.x * p.x + p.y * p.y; </span>// d is the 'radius' of this fragment from center of its bump</font></p>
<p style="margin:0px 0px 0px 0px;font:13.0px 'Courier New';color:#008419"><font size="3"><span style="color:#d2d2d2">&nbsp; &nbsp; <span>&nbsp;&nbsp; &nbsp;</span>f = </span><span style="color:#9a1f90">1.0</span><span style="color:#d2d2d2"> / sqrt(d + </span><span style="color:#9a1f90">1.0</span><span style="color:#d2d2d2">);&nbsp; </span>// f normalizes length of the normal: sqrt(x^2 + y^2 + z^2)</font></p>
<p style="margin:0px 0px 0px 0px;font:13.0px 'Courier New';color:#d2d2d2;min-height:15.0px"><font size="3"><br>
</font></p>
<p style="margin:0px 0px 0px 0px;font:13.0px 'Courier New';color:#008419"><font size="3"><span style="color:#d2d2d2">&nbsp; &nbsp; </span>// if we are outside the area of a bump then normal points straight out Z w/ length 1</font></p>
<p style="margin:0px 0px 0px 0px;font:13.0px 'Courier New';color:#d2d2d2"><font size="3">&nbsp; &nbsp; <span>&nbsp;&nbsp; &nbsp;</span><span style="color:#002efa">if</span> (d &gt;= BumpSize)</font></p>
<p style="margin:0px 0px 0px 0px;font:13.0px 'Courier New';color:#d2d2d2"><font size="3">&nbsp; &nbsp; <span>&nbsp;&nbsp; &nbsp;</span>{</font></p>
<p style="margin:0px 0px 0px 0px;font:13.0px 'Courier New';color:#d2d2d2"><font size="3">&nbsp; &nbsp; &nbsp; &nbsp; <span>&nbsp;&nbsp; &nbsp;</span>p = <span style="color:#002efa">vec2</span>(<span style="color:#9a1f90">0.0</span>);</font></p>
<p style="margin:0px 0px 0px 0px;font:13.0px 'Courier New';color:#d2d2d2"><font size="3">&nbsp; &nbsp; &nbsp; &nbsp; <span>&nbsp;&nbsp; &nbsp;</span>f = <span style="color:#9a1f90">1.0</span>;</font></p>
<p style="margin:0px 0px 0px 0px;font:13.0px 'Courier New';color:#d2d2d2"><font size="3">&nbsp; &nbsp; <span>&nbsp;&nbsp; &nbsp;</span>}</font></p>
<p style="margin:0px 0px 0px 0px;font:13.0px 'Courier New';color:#d2d2d2;min-height:15.0px"><font size="3"><br>
</font></p>
<p style="margin:0px 0px 0px 0px;font:13.0px 'Courier New';color:#008419"><font size="3"><span style="color:#d2d2d2">&nbsp; &nbsp; </span>// create a new normal of length 1 for this fragment</font></p>
<p style="margin:0px 0px 0px 0px;font:13.0px 'Courier New';color:#d2d2d2"><font size="3">&nbsp; &nbsp; <span>&nbsp;&nbsp; &nbsp;</span><span style="color:#002efa">vec3</span> normDelta = <span style="color:#002efa">vec3</span> (p.x, p.y, <span style="color:#9a1f90">1.0</span>) * f;</font></p>
<p style="margin:0px 0px 0px 0px;font:13.0px 'Courier New';color:#d2d2d2;min-height:15.0px"><font size="3"><br>
</font></p>
<p style="margin:0px 0px 0px 0px;font:13.0px 'Courier New';color:#d2d2d2"><font size="3">&nbsp; &nbsp; <span>&nbsp;&nbsp; &nbsp;</span>litColor = part.xyz * max(dot(normDelta, LightDir), <span style="color:#9a1f90">0.0</span>);</font></p>
<p style="margin:0px 0px 0px 0px;font:13.0px 'Courier New';color:#d2d2d2"><font size="3">&nbsp; &nbsp; <span>&nbsp;&nbsp; &nbsp;</span><span style="color:#002efa">vec3</span> reflectDir = reflect(LightDir, normDelta);</font></p>
<p style="margin:0px 0px 0px 0px;font:13.0px 'Courier New';color:#d2d2d2;min-height:15.0px"><font size="3"><br>
</font></p>
<p style="margin:0px 0px 0px 0px;font:13.0px 'Courier New';color:#d2d2d2"><font size="3">&nbsp; &nbsp; <span>&nbsp;&nbsp; &nbsp;</span><span style="color:#002efa">float</span> spec = max(dot(EyeDir, reflectDir), <span style="color:#9a1f90">0.0</span>);</font></p>
<p style="margin:0px 0px 0px 0px;font:13.0px 'Courier New';color:#d2d2d2"><font size="3">&nbsp; &nbsp; <span>&nbsp;&nbsp; &nbsp;</span>spec = pow(spec, <span style="color:#9a1f90">6.0</span>);</font></p>
<p style="margin:0px 0px 0px 0px;font:13.0px 'Courier New';color:#d2d2d2"><font size="3">&nbsp; &nbsp; <span>&nbsp;&nbsp; &nbsp;</span>spec *= SpecularFactor;</font></p>
<p style="margin:0px 0px 0px 0px;font:13.0px 'Courier New';color:#d2d2d2"><font size="3">&nbsp; &nbsp; <span>&nbsp;&nbsp; &nbsp;</span>litColor = min(litColor + spec, <span style="color:#002efa">vec3</span> (<span style="color:#9a1f90">1.0</span>));</font></p>
<p style="margin:0px 0px 0px 0px;font:13.0px 'Courier New';color:#d2d2d2;min-height:15.0px"><font size="3"><br>
</font></p>
<p style="margin:0px 0px 0px 0px;font:13.0px 'Courier New';color:#d2d2d2"><font size="3">&nbsp; &nbsp; <span>&nbsp;&nbsp; &nbsp;</span>sum = <span style="color:#002efa">vec4</span> (litColor, <span style="color:#9a1f90">1.0</span>);</font></p>
<p style="margin:0px 0px 0px 0px;font:13.0px 'Courier New';color:#d2d2d2"><font size="3"><span>&nbsp;&nbsp; &nbsp;</span>}</font></p>
<p style="margin:0px 0px 0px 0px;font:13.0px 'Courier New';color:#d2d2d2"><br>
</p>
</span></font></div>
<div><font size="3"><span style="line-height:20px">Main program:</span></font></div>
<div><font size="3"><span style="line-height:20px"><span style="line-height:16px"><font size="3"><span style="font-size:13px;line-height:20px">
<p style="margin-top:0px;margin-right:0px;margin-bottom:0px;margin-left:0px;font:normal normal normal 13px/normal 'Courier New';color:rgb(210,210,210)"><font size="3"><span style="color:rgb(0,46,250)"><span>&nbsp;&nbsp; &nbsp;</span>void</span>&nbsp;renderScene(<span style="color:rgb(0,46,250)">void</span>)</font></p>
</span><span style="color:rgb(210,210,210);font-family:Courier New;line-height:normal"><span>&nbsp;&nbsp; &nbsp;</span>{</span></font><span style="line-height:20px">
<p style="font-size:13px;margin-top:0px;margin-right:0px;margin-bottom:0px;margin-left:0px;font:normal normal normal 13px/normal 'Courier New';color:rgb(210,210,210)"><font size="3"><span><span><span>&nbsp;&nbsp; &nbsp;<span>&nbsp;&nbsp; &nbsp;</span></span>...</span></span><br>
</font></p>
<p style="font-size:13px;margin-top:0px;margin-right:0px;margin-bottom:0px;margin-left:0px;font:normal normal normal 13px/normal 'Courier New';color:rgb(210,210,210)"><span><span><font size="3"><br>
</font></span></span></p>
<p style="font-size:13px;margin-top:0px;margin-right:0px;margin-bottom:0px;margin-left:0px;font:normal normal normal 13px/normal 'Courier New';color:rgb(0,132,25)"><font size="3"><span style="color:rgb(210,210,210)"><span style="white-space:pre">	</span></span>// draw lower right image - Shi</font></p>
</span></span></span><span style="color:rgb(210,210,210);font-family:Courier New;line-height:normal"><span style="white-space:pre">	</span><span style="color:rgb(0,46,250)">if</span>&nbsp;(mode ==&nbsp;<span style="color:rgb(229,30,18)">'w'</span>)</span><span style="line-height:20px"><span style="line-height:16px"><span style="line-height:20px">
<p style="font-size:13px;margin-top:0px;margin-right:0px;margin-bottom:0px;margin-left:0px;font:normal normal normal 13px/normal 'Courier New';color:rgb(210,210,210)"><font size="3"><span style="white-space:pre">	</span>{</font></p>
</span></span></span><span style="color:rgb(210,210,210);font-family:Courier New;line-height:normal"><span>&nbsp;&nbsp; &nbsp;<span>&nbsp;&nbsp; &nbsp;<span>&nbsp;&nbsp; &nbsp;</span></span></span>gluLookAt(<span style="color:rgb(154,31,144)">0.0</span>,<span style="color:rgb(154,31,144)">0.0</span>,<span style="color:rgb(154,31,144)">5.0</span>,</span></font></div>
<div><font size="3"><span style="color:rgb(210,210,210);font-family:Courier New;line-height:normal"><span style="color:rgb(154,31,144)"><span>&nbsp;&nbsp; &nbsp;<span>&nbsp;&nbsp; &nbsp;<span>&nbsp;&nbsp; &nbsp;<span>&nbsp;&nbsp; &nbsp;</span></span></span></span>0.0</span>,<span style="color:rgb(154,31,144)">0.0</span>,-<span style="color:rgb(154,31,144)">1.0</span>,</span></font></div>
<div><font size="3"><span style="color:rgb(154,31,144);font-family:Courier New;line-height:normal"><span>&nbsp;&nbsp; &nbsp;<span>&nbsp;&nbsp; &nbsp;<span>&nbsp;&nbsp; &nbsp;<span>&nbsp;&nbsp; &nbsp;</span></span></span></span>0.0f<span style="color:rgb(210,210,210)">,</span>1.0f<span style="color:rgb(210,210,210)">,</span>0.0f<span style="color:rgb(210,210,210)">);</span></span><span style="line-height:20px"><span style="line-height:16px"><span style="line-height:20px">
<p style="font-size:13px;margin-top:0px;margin-right:0px;margin-bottom:0px;margin-left:0px;font:normal normal normal 13px/normal 'Courier New';color:rgb(210,210,210)"><font size="3"><span style="color:rgb(0,46,250)"><span>&nbsp;&nbsp; &nbsp;<span>&nbsp;&nbsp; &nbsp;<span>&nbsp;&nbsp; &nbsp;</span></span></span>if</span>&nbsp;(currentWindow ==&nbsp;<span style="color:rgb(154,31,144)">1</span>)</font></p>
<p style="font-size:13px;margin-top:0px;margin-right:0px;margin-bottom:0px;margin-left:0px;font:normal normal normal 13px/normal 'Courier New';color:rgb(0,132,25)"><font size="3"><span style="color:rgb(210,210,210)"><span style="white-space:pre">	<span>&nbsp;&nbsp; &nbsp;</span></span></span>// draw bump mapping - Shi</font></p>
<p style="font-size:13px;margin-top:0px;margin-right:0px;margin-bottom:0px;margin-left:0px;font:normal normal normal 13px/normal 'Courier New';color:rgb(210,210,210)"><font size="3"><span style="white-space:pre">	<span>&nbsp;&nbsp; &nbsp;</span></span>{</font></p>
</span></span></span><span style="color:rgb(210,210,210);font-family:Courier New;line-height:normal"><span>&nbsp;&nbsp; &nbsp;<span>&nbsp;&nbsp; &nbsp;<span>&nbsp;&nbsp; &nbsp;<span>&nbsp;&nbsp; &nbsp;</span></span></span></span>glRotatef(rotAmount,&nbsp;<span style="color:rgb(154,31,144)">0</span>,&nbsp;<span style="color:rgb(154,31,144)">1</span>,&nbsp;<span style="color:rgb(154,31,144)">0</span>);</span></font></div>
<div><font size="3"><span style="color:rgb(210,210,210);font-family:Courier New;line-height:normal"><span>&nbsp;&nbsp; &nbsp;<span>&nbsp;&nbsp; &nbsp;<span>&nbsp;&nbsp; &nbsp;<span>&nbsp;&nbsp; &nbsp;</span></span></span></span>effectLoc = glGetUniformLocation(p,&nbsp;<span style="color:rgb(216,103,202)">"whichEffect"</span>);</span></font></div>
<div><font size="3"><span style="color:rgb(210,210,210);font-family:Courier New;line-height:normal"><span>&nbsp;&nbsp; &nbsp;<span>&nbsp;&nbsp; &nbsp;<span>&nbsp;&nbsp; &nbsp;<span>&nbsp;&nbsp; &nbsp;</span></span></span></span>glUniform1i(effectLoc,&nbsp;<span style="color:rgb(154,31,144)">3</span>&nbsp;+&nbsp;<span style="color:rgb(154,31,144)">4</span>&nbsp;* currentWindow);</span></font></div>
<div><font color="#d2d2d2" face="'Courier New'" size="3"><span style="line-height:normal"><br>
</span></font></div>
<div><font size="3"><span style="color:rgb(210,210,210);font-family:Courier New;line-height:normal"><span>&nbsp;&nbsp; &nbsp;<span>&nbsp;&nbsp; &nbsp;<span>&nbsp;&nbsp; &nbsp;<span>&nbsp;&nbsp; &nbsp;</span></span></span></span>drawPolygon(-<span style="color:rgb(154,31,144)">1.5f</span>, -<span style="color:rgb(154,31,144)">1.5f</span>,&nbsp;<span style="color:rgb(154,31,144)">1.5f</span>,&nbsp;<span style="color:rgb(154,31,144)">1.5f</span>);</span><span style="color:rgb(210,210,210);font-family:Courier New;line-height:normal">&nbsp; &nbsp;&nbsp;<span>&nbsp;&nbsp; &nbsp;<span>&nbsp;&nbsp; &nbsp;<span>&nbsp; &nbsp;</span></span></span></span><span style="line-height:20px"><span style="line-height:16px"><span style="line-height:20px">
<p style="margin-top:0px;margin-right:0px;margin-bottom:0px;margin-left:0px;font:normal normal normal 13px/normal 'Courier New';color:rgb(210,210,210)"><font size="3"><span style="white-space:pre">	<span>&nbsp;&nbsp; &nbsp;</span></span>}</font></p>
<p style="font-size:13px;margin-top:0px;margin-right:0px;margin-bottom:0px;margin-left:0px;font:normal normal normal 13px/normal 'Courier New';color:rgb(210,210,210)"><font size="3"><span>&nbsp;&nbsp; &nbsp;<span>&nbsp;&nbsp; &nbsp;<span>&nbsp;&nbsp; &nbsp;</span><span><span>...</span></span></span></span></font></p>
<p style="font-size:13px;margin-top:0px;margin-right:0px;margin-bottom:0px;margin-left:0px;font:normal normal normal 13px/normal 'Courier New';color:rgb(210,210,210)"><font size="3"><span><span><span><span><span>&nbsp;&nbsp; &nbsp;<span>&nbsp;&nbsp; &nbsp;</span></span>}</span></span></span></span></font></p>
</span></span></span><span style="color:rgb(210,210,210);font-family:Courier New;line-height:normal">
<div><font size="3"><span style="color:rgb(210,210,210);font-family:Courier New;line-height:normal"><br>
</span></font></div>
&nbsp; &nbsp;&nbsp;<span>&nbsp; &nbsp; ...</span></span><span style="line-height:20px"><span style="line-height:16px"><span style="line-height:20px">
<p style="margin-top:0px;margin-right:0px;margin-bottom:0px;margin-left:0px;font:normal normal normal 13px/normal 'Courier New';color:rgb(210,210,210);min-height:15px"><font size="3"><span><span><br>
</span></span></font></p>
<p style="margin-top:0px;margin-right:0px;margin-bottom:0px;margin-left:0px;font:normal normal normal 13px/normal 'Courier New';color:rgb(210,210,210)"><font size="3"><span>&nbsp;&nbsp; &nbsp;<span>&nbsp;&nbsp; &nbsp;</span></span>rotAmount += <span style="color:rgb(154,31,144)">1.5</span>;</font></p>
<p style="font-size:13px;margin-top:0px;margin-right:0px;margin-bottom:0px;margin-left:0px;font:normal normal normal 13px/normal 'Courier New';color:rgb(210,210,210)"><font size="3"><span style="white-space:pre">	</span>glutSwapBuffers();</font></p>
<p style="font-size:13px;margin-top:0px;margin-right:0px;margin-bottom:0px;margin-left:0px;font:normal normal normal 13px/normal 'Courier New';color:rgb(210,210,210)"><font size="3"><span>&nbsp;&nbsp; &nbsp;</span>}</font></p>
</span></span></span></font></div>
<div><font size="3"><span style="line-height:20px"><br>
</span></font></div>
<div><font size="3"><span style="line-height:20px">- Memo:</span></font></div>
<div><font size="3"><span style="line-height:20px">Reference: course note.</span></font></div>
<div><font size="3">I changed some parameters from the&nbsp;example&nbsp;procedural bump mapping code to&nbsp;make the original circles look like Chinese lanterns.</font></div>
<div><br>
</div>
<div>
<div style="display:block;margin-right:auto;margin-left:auto;text-align:center"><a href="http://pica.nipic.com/2008-01-12/200811293247698_2.jpg" imageanchor="1"><img alt="chinese lantern" border="0" height="320" src="http://pica.nipic.com/2008-01-12/200811293247698_2.jpg" width="144"></a></div>
<br>
</div>
<div><font size="5">5. What I've been through - The Development Log</font></div>
<div><br>
</div>
<div><font face="georgia, serif" size="3">First several days: The idea of recording the development log had not come to me at that time, so there is no record for the beginning days. In general, these days I learned GLSL, read some sample code and managed to figure them all out.</font></div>
<div><font size="3"><span style="line-height:20px"><br>
</span></font></div>
<div>
<div>
<div><span style="border-collapse:separate;font-family:Georgia;line-height:normal;text-align:-webkit-auto"><font size="3">1/23 Add: Use keyboard to control grids</font></span></div>
<div><span style="font-family:Georgia;line-height:normal;text-align:-webkit-auto"><font size="3">1/23 Add: Use mouse to control</font></span></div>
<div><span style="border-collapse:separate;font-family:Georgia;line-height:normal;text-align:-webkit-auto"><font size="3"><br>
</font></span></div>
<div><span style="border-collapse:separate;font-family:Georgia;line-height:normal;text-align:-webkit-auto"><font size="3">1/24 <font color="#ff0000">Need: Install OpenCV on my macbook.</font> (This is the day I suddenly noticed that I can't give a presentation in Cyber-Commons using my desktop PC)</font></span></div>
<div><span style="border-collapse:separate;font-family:Georgia;line-height:normal;text-align:-webkit-auto"><font size="3"><br>
</font></span></div>
<div><span style="border-collapse:separate;font-family:Georgia;line-height:normal;text-align:-webkit-auto"><font size="3">1/26 Add: 16*16 mosaic effect</font></span></div>
<div><span style="border-collapse:separate;font-family:Georgia;line-height:normal;text-align:-webkit-auto"><font size="3">Based on Chris Qin, changed the code according to the characteristic of Texture2DRect()</font></span></div>
<div><span style="border-collapse:separate;font-family:Georgia;line-height:normal;text-align:-webkit-auto"><font size="3">1/26 Add: sculpture effect</font></span></div>
<div><span style="border-collapse:separate;font-family:Georgia;line-height:normal;text-align:-webkit-auto"><font size="3">Based on the Chinese website that referred by Chris Qin, changed the code from HLSL to GLSL</font></span></div>
<div><span style="border-collapse:separate;font-family:Georgia;line-height:normal;text-align:-webkit-auto"><font size="3">1/26 Add: failing old photo effect</font></span></div>
<div><span style="border-collapse:separate;font-family:Georgia;line-height:normal;text-align:-webkit-auto"><font size="3">Based on Hyejung Hur, couldn't make it beautiful</font></span></div>
<div><span style="border-collapse:separate;font-family:Georgia;line-height:normal;text-align:-webkit-auto"><font size="3"><br>
</font></span></div>
<div><span style="border-collapse:separate;font-family:Georgia;line-height:normal;text-align:-webkit-auto"><font size="3">1/27 Add: updated old photo effect</font></span></div>
<div><span style="border-collapse:separate;font-family:Georgia;line-height:normal;text-align:-webkit-auto"><font size="3">Discussed with Hyejung Hur, changed some code of old photo effect</font></span></div>
<div><span style="border-collapse:separate;font-family:Georgia;line-height:normal;text-align:-webkit-auto"><font size="3"><br>
</font></span></div>
<div><span style="border-collapse:separate;font-family:Georgia;line-height:normal;text-align:-webkit-auto"><font size="3">1/28 Add: Use keyboard to change pages</font></span></div>
<div><span style="border-collapse:separate;font-family:Georgia;line-height:normal;text-align:-webkit-auto"><font size="3">1/28 <font color="#ff0000">Need: Rewrite renderScene() since environment mapping is using a different method to render the scene.</font></font></span></div>
<div><span style="border-collapse:separate;font-family:Georgia;line-height:normal;text-align:-webkit-auto"><font size="3">1/28 <font color="#00ffff">Solve: Rewrote renderScene(), still got problem with teapot in grid mode.</font></font></span></div>
<div><span style="font-size:medium;font-family:Georgia;line-height:normal;text-align:-webkit-auto">1/28 </span><font color="#ff0000" style="font-size:medium;font-family:Georgia;line-height:normal;text-align:-webkit-auto">Need: Solve teapot problem in mode z.</font></div>
<div style="text-align:-webkit-auto"><font face="Georgia" size="3"><span style="line-height:normal">1/28 Add: ugly environment mapping effect.</span></font></div>
<div style="text-align:-webkit-auto"><font face="Georgia" size="3"><span style="line-height:normal">1/28 Add: frame of old photo effect.</span></font></div>
<div style="text-align:-webkit-auto"><font face="Georgia" size="3"><span style="line-height:normal">1/28 Add: ugly bump mapping effect.</span></font></div>
<div style="text-align:-webkit-auto"><font face="Georgia" size="3"><span style="line-height:normal">1/28 <font color="#ff0000">Need: 1. can't go into bump mapping effect after entered environment mapping; 2. problem with fullscreen bump mapping.</font></span></font></div>
<div style="text-align:-webkit-auto"><font face="Georgia" size="3"><span style="line-height:normal">1/28 <font color="#00ffff">Solve: solve both of above by realizing that 0 - 800 coordinate system should be used instead of 0 - 1.</font></span></font></div>
<div style="text-align:-webkit-auto"><font face="Georgia" size="3"><span style="line-height:normal"><br>
</span></font></div>
<div style="text-align:-webkit-auto"><font face="Georgia" size="3"><span style="line-height:normal">1/29 <font color="#ff0000">Need: Find setNoiseFrequency() and noise3() to continue writing old photo effect.</font></span></font></div>
<div style="text-align:-webkit-auto"><font face="Georgia" size="3"><span style="line-height:normal"><br>
</span></font></div>
<div style="text-align:-webkit-auto"><font face="Georgia" size="3"><span style="line-height:normal">1/30 <font color="#00ffff">Solve: Got above two functions from Andy.</font></span></font></div>
<div style="text-align:-webkit-auto"><font face="Georgia" size="3"><span style="line-height:normal"><br>
</span></font></div>
<div style="text-align:-webkit-auto"><font face="Georgia" size="3"><span style="line-height:normal">1/31 <font color="#00ffff">Solve: 1. Planted application to Mac OS; 2. can't go into bump mapping problem disappear itself.</font></span></font></div>
<div style="text-align:-webkit-auto"><font face="Georgia" size="3"><span style="line-height:normal"><br>
</span></font></div>
<div style="text-align:-webkit-auto"><font face="Georgia" size="3"><span style="line-height:normal">2/1 Add: more keyboard functions to let users come back to grid mode whenever current page is changed, so that they won't be confused.</span></font></div>
<div style="text-align:-webkit-auto"><font face="Georgia" size="3"><span style="line-height:normal">2/1 Add: Changed circles in bump mapping effect to Chinese lantern.</span></font></div>
<div style="text-align:-webkit-auto"><font face="Georgia" size="3"><span style="line-height:normal"><br>
</span></font></div>
<div style="text-align:-webkit-auto"><font face="Georgia" size="3"><span style="line-height:normal">2/2 Add: Gave different window different window titles to give users feedback.</span></font></div>
<div style="text-align:-webkit-auto"><font face="Georgia" size="3"><span style="line-height:normal">2/2 Add: Passive mouse motion control of environment mapping effect. (Finally figured out the reason it didn't work earlier is that I forgot to add glutPassiveMotionFunc() in main OpenGL application.</span></font></div>
<div style="text-align:-webkit-auto"><font face="Georgia" size="3"><span style="line-height:normal"><br>
</span></font></div>
<div style="text-align:-webkit-auto"><font face="Georgia" size="3"><span style="line-height:normal">2/3 Add: Finally knew why noise effect couldn't work. The reason is I forgot I commented&nbsp;</span></font><span style="line-height:18px"><font size="3"><font face="'Courier New'">make3DNoiseTexture();</font><font face="georgia, serif">in main application.</font></font></span></div>
<div style="text-align:-webkit-auto"><span style="line-height:18px"><font size="3"><font face="georgia, serif"><br>
</font></font></span></div>
<div style="text-align:-webkit-auto"><span style="line-height:18px"><font size="3"><font face="georgia, serif">2/4 <font color="#ff0000">Need: 1. screen recording software on Mac OS; 2. stop the application from swallow all the memory.</font></font></font></span></div>
<div style="text-align:-webkit-auto"><span style="line-height:18px"><font size="3"><font face="georgia, serif">2/4 <font color="#00ffff">Solve: found a screen recording software on Mac OS.</font></font></font></span></div>
<div style="text-align:-webkit-auto"><span style="line-height:18px"><font size="3"><font face="georgia, serif"><br>
</font></font></span></div>
<div style="text-align:-webkit-auto"><span style="line-height:18px"><font size="3"><font face="georgia, serif">2/5 <font color="#ff0000">Need: stop the application's more than 100% CPU occupancy rate.</font></font></font></span></div>
<div style="text-align:-webkit-auto"><span style="line-height:18px"><font size="3"><font face="georgia, serif">2/5 <font color="#00ffff">Solve: checked whole system, then checked whole code, after making some modification, problem solved.</font></font></font></span></div>
<div style="text-align:-webkit-auto"><font face="georgia, serif" size="3"><span style="line-height:18px">2/5 Add: a demo video and some snapshots.</span></font></div>
<div><span style="white-space:pre-wrap"><br>
</span></div>
</div>
</div>
<div><br>
</div>
<font size="5">
6. Who to Thank</font>
<div><br>
<div><font face="georgia, serif" size="3">Andy Johnson</font></div>
<div><font face="georgia, serif" size="3"><br>
lighthouse3d.com<br>
<br>
Hyejung Hur<br>
<br>
Chris Qin<br>
<br>
ozone3d.net<br>
<br>
Brian Mykietka<br>
<br>
Wojciech Niedbala</font>
<div><span style="white-space:pre-wrap"><br>
</span></div>
<div><font size="5"><span style="line-height:30px;white-space:pre-wrap">Epilogue</span></font><span style="white-space:pre-wrap"><font size="5">. What I Learned</font></span></div>
<div><span style="white-space:pre-wrap"><br>
</span></div>
<div><span style="white-space:pre-wrap"><font size="3">Looking at the development log, seems to be a easy job. But actually the process is not as straightforward as recorded in the log. One line of "Add" in the log maybe means a whole day of reading, coding, thinking, debugging and frustrating.</font></span></div>
<div><span style="white-space:pre-wrap"><font size="3">
</font></span></div>
<div><font size="3"><span style="white-space:pre-wrap">Well, but who can say that was not fun experience, playing with and played by the&nbsp;</span><span style="white-space:pre-wrap">full of craft </span><span style="white-space:pre-wrap">shaders.</span></font></div>
<div><span style="white-space:pre-wrap"><font size="3">
</font></span></div>
<div><span style="white-space:pre-wrap"><font size="3">It's a pity that I don't have time to learn more. Because, at the first week, I learned too inefficiently, stuck by a lot of irrelevant material, took too much time to choose effects (Gee there are too many fabulous effect attracting me when I going deeper and deeper in shading world), I have no time to finish the third page. Forgive me, geometry shader.</font></span></div>
<div><span style="white-space:pre-wrap"><font size="3">
</font></span></div>
<div><font size="3"><span style="white-space:pre-wrap">Even though this time is&nbsp;unprecedented in term of 'how early to start',</span><span style="white-space:pre-wrap"> I think I still have lots of space to improve on calendar planning, especially on multi-threads planning - </span><span style="white-space:pre-wrap">I didn't realize CS 422 project is so time-consuming.</span></font></div>
<div><span style="white-space:pre-wrap"><font size="3">
</font></span></div>
<div><span style="white-space:pre-wrap"><font size="3">If I got free time later, I'll come back to make this project more beautiful.</font></span></div>
</div>
</div>
