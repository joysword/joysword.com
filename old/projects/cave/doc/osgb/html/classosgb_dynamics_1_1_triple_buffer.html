<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.3.1"/>
<title>osgBullet: osgbDynamics::TripleBuffer Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">osgBullet
   &#160;<span id="projectnumber">osgBullet 2.00.02</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.3.1 -->
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li class="current"><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="annotated.html"><span>Class&#160;List</span></a></li>
      <li><a href="classes.html"><span>Class&#160;Index</span></a></li>
      <li><a href="hierarchy.html"><span>Class&#160;Hierarchy</span></a></li>
      <li><a href="functions.html"><span>Class&#160;Members</span></a></li>
    </ul>
  </div>
<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><b>osgbDynamics</b></li><li class="navelem"><a class="el" href="classosgb_dynamics_1_1_triple_buffer.html">TripleBuffer</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pro-types">Protected Types</a> &#124;
<a href="#pro-methods">Protected Member Functions</a> &#124;
<a href="#pro-attribs">Protected Attributes</a> &#124;
<a href="#related">Related Functions</a> &#124;
<a href="classosgb_dynamics_1_1_triple_buffer-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">osgbDynamics::TripleBuffer Class Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>A triple buffer mechanism to support physics and rendering in separate threads.  
 <a href="classosgb_dynamics_1_1_triple_buffer.html#details">More...</a></p>

<p><code>#include &lt;<a class="el" href="_triple_buffer_8h_source.html">osgbDynamics/TripleBuffer.h</a>&gt;</code></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:a03498b29ae0dcc24afce4f7408e7c59d"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a03498b29ae0dcc24afce4f7408e7c59d"></a>
&#160;</td><td class="memItemRight" valign="bottom"><b>TripleBuffer</b> (unsigned int initialSize=8192)</td></tr>
<tr class="separator:a03498b29ae0dcc24afce4f7408e7c59d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae068b0ec4f1f2cda236dc5916477fcd4"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classosgb_dynamics_1_1_triple_buffer.html#ae068b0ec4f1f2cda236dc5916477fcd4">resize</a> (unsigned int size)</td></tr>
<tr class="memdesc:ae068b0ec4f1f2cda236dc5916477fcd4"><td class="mdescLeft">&#160;</td><td class="mdescRight">Sets the maximum size of all three buffers.  <a href="#ae068b0ec4f1f2cda236dc5916477fcd4">More...</a><br/></td></tr>
<tr class="separator:ae068b0ec4f1f2cda236dc5916477fcd4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2907c9fd00290ebfaea237e2c95def03"><td class="memItemLeft" align="right" valign="top">unsigned int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classosgb_dynamics_1_1_triple_buffer.html#a2907c9fd00290ebfaea237e2c95def03">reserve</a> (unsigned int size, char *data=NULL)</td></tr>
<tr class="memdesc:a2907c9fd00290ebfaea237e2c95def03"><td class="mdescLeft">&#160;</td><td class="mdescRight">Reserve a chunk of memory.  <a href="#a2907c9fd00290ebfaea237e2c95def03">More...</a><br/></td></tr>
<tr class="separator:a2907c9fd00290ebfaea237e2c95def03"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a56bd8bad5bc941c1fcc373734b2c2148"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a56bd8bad5bc941c1fcc373734b2c2148"></a>
char *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classosgb_dynamics_1_1_triple_buffer.html#a56bd8bad5bc941c1fcc373734b2c2148">beginWrite</a> ()</td></tr>
<tr class="memdesc:a56bd8bad5bc941c1fcc373734b2c2148"><td class="mdescLeft">&#160;</td><td class="mdescRight">Mark an INVALID buffer as WRITE and return its address. <br/></td></tr>
<tr class="separator:a56bd8bad5bc941c1fcc373734b2c2148"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adaa41412dd2f4dff45402ad9e151e26a"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="adaa41412dd2f4dff45402ad9e151e26a"></a>
char *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classosgb_dynamics_1_1_triple_buffer.html#adaa41412dd2f4dff45402ad9e151e26a">writeAddress</a> ()</td></tr>
<tr class="memdesc:adaa41412dd2f4dff45402ad9e151e26a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Return the address of the current WRITE buffer. <br/></td></tr>
<tr class="separator:adaa41412dd2f4dff45402ad9e151e26a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a869fac745f8fdabbcb68acf2958d59b5"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a869fac745f8fdabbcb68acf2958d59b5"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classosgb_dynamics_1_1_triple_buffer.html#a869fac745f8fdabbcb68acf2958d59b5">endWrite</a> ()</td></tr>
<tr class="memdesc:a869fac745f8fdabbcb68acf2958d59b5"><td class="mdescLeft">&#160;</td><td class="mdescRight">Mark the current WRITE buffer as UPDATED. <br/></td></tr>
<tr class="separator:a869fac745f8fdabbcb68acf2958d59b5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0399fe6979e7c9882c9e5f9da9a33e60"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a0399fe6979e7c9882c9e5f9da9a33e60"></a>
char *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classosgb_dynamics_1_1_triple_buffer.html#a0399fe6979e7c9882c9e5f9da9a33e60">beginRead</a> ()</td></tr>
<tr class="memdesc:a0399fe6979e7c9882c9e5f9da9a33e60"><td class="mdescLeft">&#160;</td><td class="mdescRight">Mark an UPDATED buffer as READ and return its address. <br/></td></tr>
<tr class="separator:a0399fe6979e7c9882c9e5f9da9a33e60"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5f1c3d9091d8e9ddeac7a5c7b8176948"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a5f1c3d9091d8e9ddeac7a5c7b8176948"></a>
char *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classosgb_dynamics_1_1_triple_buffer.html#a5f1c3d9091d8e9ddeac7a5c7b8176948">readAddress</a> ()</td></tr>
<tr class="memdesc:a5f1c3d9091d8e9ddeac7a5c7b8176948"><td class="mdescLeft">&#160;</td><td class="mdescRight">Return the address of the current READ buffer. <br/></td></tr>
<tr class="separator:a5f1c3d9091d8e9ddeac7a5c7b8176948"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3f0389918a3313df895245817baf5a03"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a3f0389918a3313df895245817baf5a03"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classosgb_dynamics_1_1_triple_buffer.html#a3f0389918a3313df895245817baf5a03">endRead</a> ()</td></tr>
<tr class="memdesc:a3f0389918a3313df895245817baf5a03"><td class="mdescLeft">&#160;</td><td class="mdescRight">Mark the current READ buffer as INVALID. <br/></td></tr>
<tr class="separator:a3f0389918a3313df895245817baf5a03"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a34e02beb31a27541f60b120834b9bc82"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a34e02beb31a27541f60b120834b9bc82"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classosgb_dynamics_1_1_triple_buffer.html#a34e02beb31a27541f60b120834b9bc82">debugDump</a> (const std::string &amp;msg, std::ostream &amp;oStr) const </td></tr>
<tr class="memdesc:a34e02beb31a27541f60b120834b9bc82"><td class="mdescLeft">&#160;</td><td class="mdescRight">Useful during development. <br/></td></tr>
<tr class="separator:a34e02beb31a27541f60b120834b9bc82"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pro-types"></a>
Protected Types</h2></td></tr>
<tr class="memitem:acb469d85da90b07f86b0022f3331759e"><td class="memItemLeft" align="right" valign="top">enum &#160;</td><td class="memItemRight" valign="bottom"><b>BufferStatus</b> { <b>INVALID</b> = 0, 
<b>UPDATED</b> = 1, 
<b>READ</b> = 2, 
<b>WRITE</b> = 3
 }</td></tr>
<tr class="separator:acb469d85da90b07f86b0022f3331759e"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pro-methods"></a>
Protected Member Functions</h2></td></tr>
<tr class="memitem:acc6f7f1ad14301d7eeba675de3e52247"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classosgb_dynamics_1_1_triple_buffer.html#acc6f7f1ad14301d7eeba675de3e52247">get</a> (BufferStatus status)</td></tr>
<tr class="memdesc:acc6f7f1ad14301d7eeba675de3e52247"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns the buffer with the specified status.  <a href="#acc6f7f1ad14301d7eeba675de3e52247">More...</a><br/></td></tr>
<tr class="separator:acc6f7f1ad14301d7eeba675de3e52247"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afb00a88277e07d41a9a9a0a91c2f0bea"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classosgb_dynamics_1_1_triple_buffer.html#afb00a88277e07d41a9a9a0a91c2f0bea">reallocate</a> (unsigned int index, unsigned int size)</td></tr>
<tr class="memdesc:afb00a88277e07d41a9a9a0a91c2f0bea"><td class="mdescLeft">&#160;</td><td class="mdescRight">reallocate a single buffer.  <a href="#afb00a88277e07d41a9a9a0a91c2f0bea">More...</a><br/></td></tr>
<tr class="separator:afb00a88277e07d41a9a9a0a91c2f0bea"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pro-attribs"></a>
Protected Attributes</h2></td></tr>
<tr class="memitem:a61ec162df56d45cd098dadc24b137e62"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a61ec162df56d45cd098dadc24b137e62"></a>
unsigned int&#160;</td><td class="memItemRight" valign="bottom"><b>_currentSize</b></td></tr>
<tr class="separator:a61ec162df56d45cd098dadc24b137e62"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abc896d1ffe01d5600e5c26239e82b0ca"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="abc896d1ffe01d5600e5c26239e82b0ca"></a>
unsigned int&#160;</td><td class="memItemRight" valign="bottom"><b>_nextFree</b></td></tr>
<tr class="separator:abc896d1ffe01d5600e5c26239e82b0ca"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2da148b22af17772a7ccbf42337b4c76"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a2da148b22af17772a7ccbf42337b4c76"></a>
BufferStatus&#160;</td><td class="memItemRight" valign="bottom"><b>_status</b> [3]</td></tr>
<tr class="separator:a2da148b22af17772a7ccbf42337b4c76"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ada07f273510b37a1dbd225f49cc040b1"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ada07f273510b37a1dbd225f49cc040b1"></a>
char *&#160;</td><td class="memItemRight" valign="bottom"><b>_buf</b> [3]</td></tr>
<tr class="separator:ada07f273510b37a1dbd225f49cc040b1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a790859a7daff4f856f5123d606e9d451"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a790859a7daff4f856f5123d606e9d451"></a>
char *&#160;</td><td class="memItemRight" valign="bottom"><b>_writeAddress</b></td></tr>
<tr class="separator:a790859a7daff4f856f5123d606e9d451"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9c94f587f1a9f4881b87a004dd7b785d"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a9c94f587f1a9f4881b87a004dd7b785d"></a>
char *&#160;</td><td class="memItemRight" valign="bottom"><b>_readAddress</b></td></tr>
<tr class="separator:a9c94f587f1a9f4881b87a004dd7b785d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a71df8d3574390048aa4095d0a9775b93"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a71df8d3574390048aa4095d0a9775b93"></a>
OpenThreads::Mutex&#160;</td><td class="memItemRight" valign="bottom"><b>_lock</b></td></tr>
<tr class="separator:a71df8d3574390048aa4095d0a9775b93"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="related"></a>
Related Functions</h2></td></tr>
<tr><td class="ititle" colspan="2"><p>(Note that these are not member functions.) </p>
</td></tr>
<tr class="memitem:a7557277771bc17b7beebf6ef8c1ffc64"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a7557277771bc17b7beebf6ef8c1ffc64"></a>
typedef std::set<br class="typebreak"/>
&lt; <a class="el" href="classosgb_dynamics_1_1_motion_state.html">osgbDynamics::MotionState</a> * &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classosgb_dynamics_1_1_triple_buffer.html#a7557277771bc17b7beebf6ef8c1ffc64">MotionStateList</a></td></tr>
<tr class="memdesc:a7557277771bc17b7beebf6ef8c1ffc64"><td class="mdescLeft">&#160;</td><td class="mdescRight">Container class for multiple <a class="el" href="classosgb_dynamics_1_1_motion_state.html" title="A btMotionState that works with OSG Transforms.">MotionState</a> objects. <br/></td></tr>
<tr class="separator:a7557277771bc17b7beebf6ef8c1ffc64"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a205013e02edd6af7219c022b090304c9"><td class="memItemLeft" align="right" valign="top">bool OSGBDYNAMICS_EXPORT&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classosgb_dynamics_1_1_triple_buffer.html#a205013e02edd6af7219c022b090304c9">TripleBufferMotionStateUpdate</a> (osgbDynamics::MotionStateList &amp;msl, <a class="el" href="classosgb_dynamics_1_1_triple_buffer.html">osgbDynamics::TripleBuffer</a> *tb)</td></tr>
<tr class="memdesc:a205013e02edd6af7219c022b090304c9"><td class="mdescLeft">&#160;</td><td class="mdescRight">Class for updating a list of <a class="el" href="classosgb_dynamics_1_1_motion_state.html" title="A btMotionState that works with OSG Transforms.">MotionState</a> objects from a <a class="el" href="classosgb_dynamics_1_1_triple_buffer.html" title="A triple buffer mechanism to support physics and rendering in separate threads.">TripleBuffer</a>.  <a href="#a205013e02edd6af7219c022b090304c9">More...</a><br/></td></tr>
<tr class="separator:a205013e02edd6af7219c022b090304c9"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>A triple buffer mechanism to support physics and rendering in separate threads. </p>
<p>This class allows the read thread to always access the latest complete set of updated data without blocking, and allows the write thread to always switch to an available buffer to write the next set of data without blocking.</p>
<p>Multiple heterogeneous chunks of data may be stored in buffers by using <a class="el" href="classosgb_dynamics_1_1_triple_buffer.html#a2907c9fd00290ebfaea237e2c95def03" title="Reserve a chunk of memory.">reserve()</a> to specify a data size and retrieve back the unsigned int index into the <a class="el" href="classosgb_dynamics_1_1_triple_buffer.html" title="A triple buffer mechanism to support physics and rendering in separate threads.">TripleBuffer</a> storage. This index is a count of least-resolvable machine units (usually bytes).</p>
<p>In a typical usage case, each <a class="el" href="classosgb_dynamics_1_1_motion_state.html" title="A btMotionState that works with OSG Transforms.">MotionState</a> has a matrix stored in the triple buffer object. The physics sim thread wraps the stepSimulation call with <a class="el" href="classosgb_dynamics_1_1_triple_buffer.html#a56bd8bad5bc941c1fcc373734b2c2148" title="Mark an INVALID buffer as WRITE and return its address.">beginWrite()</a> and <a class="el" href="classosgb_dynamics_1_1_triple_buffer.html#a869fac745f8fdabbcb68acf2958d59b5" title="Mark the current WRITE buffer as UPDATED.">endWrite()</a>. When Bullet sets the world transform of the collision objects, <a class="el" href="classosgb_dynamics_1_1_motion_state.html" title="A btMotionState that works with OSG Transforms.">MotionState</a> intercepts the transforms and stores them in the current write buffer. Concurrently, during the scene graph update phase, the rendering thread calls <a class="el" href="classosgb_dynamics_1_1_triple_buffer.html#a0399fe6979e7c9882c9e5f9da9a33e60" title="Mark an UPDATED buffer as READ and return its address.">beginRead()</a>, uses the data to update matrices in the scene graph, then calls <a class="el" href="classosgb_dynamics_1_1_triple_buffer.html#a3f0389918a3313df895245817baf5a03" title="Mark the current READ buffer as INVALID.">endRead()</a>. </p>
</div><h2 class="groupheader">Member Function Documentation</h2>
<a class="anchor" id="ae068b0ec4f1f2cda236dc5916477fcd4"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void osgbDynamics::TripleBuffer::resize </td>
          <td>(</td>
          <td class="paramtype">unsigned int&#160;</td>
          <td class="paramname"><em>size</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Sets the maximum size of all three buffers. </p>
<p>This function reallocates the <a class="el" href="classosgb_dynamics_1_1_triple_buffer.html" title="A triple buffer mechanism to support physics and rendering in separate threads.">TripleBuffer</a> storage by calling <a class="el" href="classosgb_dynamics_1_1_triple_buffer.html#afb00a88277e07d41a9a9a0a91c2f0bea" title="reallocate a single buffer.">reallocate()</a> on all three buffers so that they contain <code>size</code> bytes of contiguous memory. Because reallocation can be expensive, applications should avoid repeated <a class="el" href="classosgb_dynamics_1_1_triple_buffer.html#ae068b0ec4f1f2cda236dc5916477fcd4" title="Sets the maximum size of all three buffers.">resize()</a> calls. In typical usage, applications call <a class="el" href="classosgb_dynamics_1_1_triple_buffer.html#ae068b0ec4f1f2cda236dc5916477fcd4" title="Sets the maximum size of all three buffers.">resize()</a> once at init time. </p>

</div>
</div>
<a class="anchor" id="a2907c9fd00290ebfaea237e2c95def03"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">unsigned int osgbDynamics::TripleBuffer::reserve </td>
          <td>(</td>
          <td class="paramtype">unsigned int&#160;</td>
          <td class="paramname"><em>size</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>data</em> = <code>NULL</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Reserve a chunk of memory. </p>
<p>Applications should call <a class="el" href="classosgb_dynamics_1_1_triple_buffer.html#a2907c9fd00290ebfaea237e2c95def03" title="Reserve a chunk of memory.">reserve()</a> whenever they want to access a chunk of data by two threads. For example, <a class="el" href="classosgb_dynamics_1_1_motion_state.html" title="A btMotionState that works with OSG Transforms.">MotionState</a> calls <a class="el" href="classosgb_dynamics_1_1_triple_buffer.html#a2907c9fd00290ebfaea237e2c95def03" title="Reserve a chunk of memory.">reserve()</a> to allocate space for a btTransform. The <code>size</code> parameter is set to sizeof(btTransform). The return value is used by the Physics thread to write the transform, and used by the <a class="el" href="classosgb_dynamics_1_1_motion_state.html" title="A btMotionState that works with OSG Transforms.">MotionState</a> to update the matrix of the OSG Transform node it manages.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">size</td><td>The size of memory to reserve. If the currently allocated mrmory plus <code>size</code> exceeds the total storage specified with <a class="el" href="classosgb_dynamics_1_1_triple_buffer.html#ae068b0ec4f1f2cda236dc5916477fcd4" title="Sets the maximum size of all three buffers.">resize()</a>, this function reallocates the <a class="el" href="classosgb_dynamics_1_1_triple_buffer.html" title="A triple buffer mechanism to support physics and rendering in separate threads.">TripleBuffer</a> storage to accomodate the request. </td></tr>
    <tr><td class="paramname">data</td><td>If specified, <code>size</code> bytes of data from this address are copied into the allocation location. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The byte offset into the <a class="el" href="classosgb_dynamics_1_1_triple_buffer.html" title="A triple buffer mechanism to support physics and rendering in separate threads.">TripleBuffer</a> storage. </dd></dl>

</div>
</div>
<a class="anchor" id="acc6f7f1ad14301d7eeba675de3e52247"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int osgbDynamics::TripleBuffer::get </td>
          <td>(</td>
          <td class="paramtype">BufferStatus&#160;</td>
          <td class="paramname"><em>status</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Returns the buffer with the specified status. </p>
<dl class="section return"><dt>Returns</dt><dd>0, 1, or 2, if a buffer is found. -1 otherwise. </dd></dl>

</div>
</div>
<a class="anchor" id="afb00a88277e07d41a9a9a0a91c2f0bea"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void osgbDynamics::TripleBuffer::reallocate </td>
          <td>(</td>
          <td class="paramtype">unsigned int&#160;</td>
          <td class="paramname"><em>index</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned int&#160;</td>
          <td class="paramname"><em>size</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>reallocate a single buffer. </p>
<p>Uses <code>new</code> to allocate the buffer, <code>memcpy</code> to copy date from the old location to the new, then uses <code>delete</code> to deallocate the old buffer. </p>

</div>
</div>
<h2 class="groupheader">Friends And Related Function Documentation</h2>
<a class="anchor" id="a205013e02edd6af7219c022b090304c9"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool OSGBDYNAMICS_EXPORT TripleBufferMotionStateUpdate </td>
          <td>(</td>
          <td class="paramtype">osgbDynamics::MotionStateList &amp;&#160;</td>
          <td class="paramname"><em>msl</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classosgb_dynamics_1_1_triple_buffer.html">osgbDynamics::TripleBuffer</a> *&#160;</td>
          <td class="paramname"><em>tb</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">related</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Class for updating a list of <a class="el" href="classosgb_dynamics_1_1_motion_state.html" title="A btMotionState that works with OSG Transforms.">MotionState</a> objects from a <a class="el" href="classosgb_dynamics_1_1_triple_buffer.html" title="A triple buffer mechanism to support physics and rendering in separate threads.">TripleBuffer</a>. </p>
<p><a class="el" href="classosgb_dynamics_1_1_triple_buffer.html" title="A triple buffer mechanism to support physics and rendering in separate threads.">TripleBuffer</a> support. Apps running Bullet is a thread separate from OSG rendering should keep a list of all <a class="el" href="classosgb_dynamics_1_1_motion_state.html" title="A btMotionState that works with OSG Transforms.">MotionState</a> objects. During update, the app should call TripleBufferMotionStateUpdate to update all <a class="el" href="classosgb_dynamics_1_1_motion_state.html" title="A btMotionState that works with OSG Transforms.">MotionState</a> objects with data from the <a class="el" href="classosgb_dynamics_1_1_triple_buffer.html" title="A triple buffer mechanism to support physics and rendering in separate threads.">TripleBuffer</a> (and push those matrices out to the OSG scene graph Transform nodes). </p>

</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li>include/osgbDynamics/<a class="el" href="_triple_buffer_8h_source.html">TripleBuffer.h</a></li>
<li>include/osgbDynamics/<a class="el" href="_motion_state_8h_source.html">MotionState.h</a></li>
<li>src/osgbDynamics/TripleBuffer.cpp</li>
</ul>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Wed Apr 10 2013 19:23:13 for osgBullet by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.3.1
</small></address>
</body>
</html>
