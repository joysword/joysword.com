<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.3.1"/>
<title>osgBullet: Support For Non-Origin Center Of Mass</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">osgBullet
   &#160;<span id="projectnumber">osgBullet 2.00.02</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.3.1 -->
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li class="current"><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">Support For Non-Origin Center Of Mass </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>Bullet dynamics always assumes the collision shape origin is the center of mass (COM). However, 3D model origins rarely coincide with the COM. A simple conversion of OSG geometric data into a collision shape would almost certainly result in incorrect dynamics due to this issue.</p>
<p>osgBullet supports 3D models with non-origin COM. The support is implemented in the <a class="el" href="classosgb_dynamics_1_1_motion_state.html">MotionState</a> class and the <a class="el" href="group__collisionshapes.html">collision shape creation utilities. </a> If your application uses the <a class="el" href="group__rigidbody.html">rigid body creation utilities, </a> then you merely specify the COM in the <a class="el" href="structosgb_dynamics_1_1_creation_record.html">CreationRecord</a>.</p>
 <div class="fragment"><div class="line">    <span class="comment">// Begin_doxygen example code block</span></div>
<div class="line">    osg::ref_ptr&lt; osgbDynamics::CreationRecord &gt; cr = <span class="keyword">new</span> <a class="code" href="structosgb_dynamics_1_1_creation_record.html" title="Data record for rigid body construction information.">osgbDynamics::CreationRecord</a>;</div>
<div class="line">    <span class="keywordflow">if</span>( setCom )</div>
<div class="line">        cr-&gt;<a class="code" href="structosgb_dynamics_1_1_creation_record.html#a55861770bd464eea9c9b7d77c58392db">setCenterOfMass</a>( com );</div>
<div class="line">    cr-&gt;_sceneGraph = mt;</div>
<div class="line">    cr-&gt;_shapeType = BOX_SHAPE_PROXYTYPE;</div>
<div class="line">    cr-&gt;_parentTransform = m;</div>
<div class="line">    cr-&gt;_restitution = 1.f;</div>
<div class="line">    btRigidBody* rb = <a class="code" href="group__rigidbody.html#ga660f32b5176377c91375c1f4204b7324" title="Creates a compound collision shape and rigid body from the CreationRecord data.">osgbDynamics::createRigidBody</a>( cr.get() );</div>
</div><!-- fragment --></p>
<p>Note that the call to setCenterOfMass() is conditional; if you don't call it, osgBullet will use the bounding volume center as the COM. However, osgBullet never uses the origin as the COM, unless you specify it directly with a call to setCenterOfMass(), or it just happens to coincide with the model origin.</p>
<p>If your application doesn't use the <a class="el" href="group__rigidbody.html">rigid body creation utilities, </a> then you should emulate the RigidBody.cpp source code.</p>
<h1><a class="anchor" id="examdescrip"></a>
The centerofmass Example</h1>
<p>The <code>centerofmass</code> example demonstrates setting COM on a 3D model. It uses the <code>com.osg</code> model file, which has its origin at the lower-left front corner. To see the model origin, use the osgWorks utility <code>osgwbvv:</code> </p>
<div class="fragment"><div class="line">osgwbvv com.osg --box --origin</div>
</div><!-- fragment --><p>Clearly, using the model origin as the COM would be incorrect. You can see this incorrect behavior when you run the example; look at the model on the left. If osgBullet (or your application) were to do a naive comversion of OSG geometric data to a Bullet collision shape, this is what you'd get.</p>
<p>If you don't specify a COM at all (that is, your application doesn't call <a class="el" href="structosgb_dynamics_1_1_creation_record.html#a55861770bd464eea9c9b7d77c58392db">osgbDynamics::CreationRecord::setCenterOfMass()</a> ), osgBullet uses the subgraph bounding volume center as the center of mass. This works well for many models, but not for <code>com.osg</code>. To see this incorrect behavior, run the example and look at the model on the right.</p>
<p>The object in the center of the example has a correct COM, which produces correct rigid body dynamics. This was accomplished using the code above.</p>
<h1><a class="anchor" id="comcontrols"></a>
UI Controls</h1>
<ul>
<li>Delete: Reset the physics simulation to its initial state. </li>
<li>ctrl-leftmouse: Select and drag an object. </li>
</ul>
</div></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Wed Apr 10 2013 19:23:13 for osgBullet by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.3.1
</small></address>
</body>
</html>
